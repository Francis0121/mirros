/*************************
 * MIT licensed
 *
 * Copyright (C) 2013 peoplegate - made by Francis ( Project : businessgate)
 * ***********************/
$(function(){$('#jt-mypage').bind('mouseover mouseout',function(event){jtown.toggleMouse($('#jt-mypage-wrap'),event.type)});$('#jt-help').bind('mouseover mouseout',function(event){jtown.toggleMouse($('#jt-help-wrap'),event.type)});jtown.comment.home();jtown.home.masonry.start();jtown.home.naturalLanguage();jtown.expand.loadExpandShop();jtown.comment.syncComment();jtown.expand.gotoPage();$('#jt-login-smartPopup').bind('click',function(){jtown.login.showLoginForm()});$('#resendConfirmMail').bind('click',function(){jtown.login.resendEmailAddress()});$('#jt-findUserPassword-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['jtownUser'];form.submit()});$('#jt-findSellerPassword-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['sellerUser'];form.submit()});$('#jt-emailAddress-user-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['jtownUser'];form.submit()});jtown.regExp('email','input[data-type=create]','#confirmEmail',0,50);jtown.regExp('onlyChar','input[data-type=createId]','#confirmEmail',0,20);jtown.regExp('empty','input[data-form=joinPw]','#passwordLength',7,16);jtown.regExp('onlyChar','input[data-form=join]','#nameLength',0,20);jtown.regExp('empty','input[data-form=modify]','#passwordLength',7,16);jtown.login.confirmPassword();jtown.login.joinFormSubmit();jtown.login.changeUserSubmit();jtown.login.disactiveUser();jtown.regExp('onlyChar','input[name=shopName]','#shopNameCheck',0,30);jtown.regExp('email','input[name=email]','#confirmEmail',0,50);jtown.regExp('euckr','input[data-form=partnership]','#nameLength',0,10);jtown.regExp('number','input[name=phoneNumberSt]','#confirmPhoneNumber',0,4);jtown.regExp('number','input[name=phoneNumberNd]','#confirmPhoneNumber',0,4);jtown.regExp('number','input[name=phoneNumberRd]','#confirmPhoneNumber',0,4);jtown.help.questionSync();$('#jt-partnership-btn').bind('click',function(){var form=document.forms['partnership'];$('#loading-popup').fadeIn();form.submit()});jtown.board.noticeWrite();$('#page-wrap').css('width',$('#page-wrap>div').width());$('#jt-naturalLanguage-search').placeholder();$('#jt-comment-insert').placeholder();$('#username_findPassword').placeholder();$('#username_findSellerPassword').placeholder();$('#j_username_page, #j_password_page').placeholder();$('#partnership_content').placeholder();$('#cQuestion #name').placeholder();$('#cQuestion #email').placeholder();$('#sQuestion #shopPn').placeholder();$('#sQuestion #name').placeholder();$('#sQuestion #email').placeholder();$('#sQuestion #content').placeholder();$('#partnership #shopUrl').placeholder();$('#partnership #email').placeholder();$('.jt-home-expand-shop-expandProducts').jCarouselLite({btnNext:".jt-home-expand-shop-leftArrow",btnPrev:".jt-home-expand-shop-rigthArrow",mouseWheel:true,speed:300,btnGo:['.0','.1','.2','.3','.4','.5','.6','.7','.8','.9','.10','.11','.12','.13','.14','.15','.16','.17','.18','.19',],afterEnd:function(e){setTimeout('jtown.seller.syncProduct()',0)}})});jtown.loading={start:function(){$('#loading-popup').fadeIn()},finish:function(){$('#loading-popup').fadeOut()}};jtown.postJSON=function(url,json,callback){jtown.loading.start();$.postJSON(url,json,function(){callback();jtown.loading.finish()})};jtown.dialog=function(message){var dialog='<div style="text-align:center; margin-top: 15px; font-weight: bold; line-height : 16px;">'+message+'</div>';$(dialog).dialog({resizable:false,width:'300px',hegiht:'200px',modal:true,buttons:{'Close':function(){$(this).dialog('close')}}});$('.ui-dialog-titlebar').removeClass('ui-widget-header');$('.ui-dialog-buttonset').css({'float':'none','text-align':'center'})};jtown.confirm=function(message,success,cancle){var dialog='<div style="text-align:center; margin-top: 25px; font-weight: bold;">'+message+'</div>';$(dialog).dialog({resizable:false,width:'300px',hegiht:'200px',modal:true,buttons:{'확인':function(){success();$(this).dialog('close')},'취소':function(){cancle();$(this).dialog('close')}}});$('.ui-dialog-titlebar').removeClass('ui-widget-header');$('.ui-dialog-buttonset').css({'float':'none','text-align':'center'})};jtown.toggleMouse=function(object,eventType){if(eventType=='mouseover')object.show();else if(eventType=='mouseout')object.hide()};jtown.regExp=function(category,name,target,first,last){if(nullValueCheck(category))return;var regExp=null;if(category=='email'){regExp=/^[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[@]{1}[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[.]{1}[A-Za-z]{2,5}$/}else if(category=='onlyChar'){regExp=/^[0-9A-Za-z가-힣]*$/}else if(category=='empty'){regExp=/^.*$/}else if(category=='euckr'){regExp=/^[가-힣]*$/}else if(category=='number'){regExp=/^[0-9]*$/}$(name).keyup(function(){var value=$(this).val(),length=$(this).val().length;if(regExp.test(value)&&(length>first&&length<=last)){$(target).children('span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$(target).children('span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){var value=$(this).val(),length=$(this).val().length;if(regExp.test(value)&&(length>first&&length<=last)){$(target).children('span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$(target).children('span').removeClass('jt-form-valid').addClass('jt-form-invalid')}$(target).show()}).blur(function(){$(target).hide()})};if(typeof jtown.home=='undefined'){jtown.home={}}jtown.home.masonry={object:{container:$('#jt-home-container')},start:function(){var $c=this.object.container;if(nullValueCheck($c.html())){return}$c.imagesLoaded(function(){$c.masonry({itemSelector:'.jt-home-shop',columnWidth:330,transitionDuration:0.})});this.pagination();this.resize();this.scrollTop();$(window).scroll(this.move);$(window).resize(this.resize)},pagination:function(){var $c=this.object.container;$c.scrollPagination({'contentPage':contextPath+'ajax/homePagination.jt','contentData':{'categoryPn':$c.attr('data-cpn'),'sectionPn':$c.attr('data-spn')},'scrollTarget':$(window),'successCallback':function(data){if($.browser.msie&&$.browser.version=='7.0'){var html=$(jtown.home.html(data));$c.append(html).masonry('appended',html);$c.imagesLoaded(function(){$c.masonry('reload')})}else{var htmlArray=jtown.home.html(data);$c.append(htmlArray).masonry('appended',htmlArray);$c.imagesLoaded(function(){$c.masonry()})}setTimeout('jtown.expand.loadExpandShop()',0);setTimeout('jtown.comment.home()',0)},'maxPage':$c.attr('data-maxPage')})},resize:function(){var clientWidth=Number(window.document.body.clientWidth),widthItem=Math.floor(clientWidth/330);if(widthItem<3)widthItem=3;$('#jt-home-container').css({width:(widthItem*330),margin:'auto'})},scrollTop:function(){$('#jt-scroll-top').bind('click',function(){$('html, body').animate({scrollTop:0},'slow')})},move:function(){var $header=$('.jt-header-title'),$footer=$('.jt-footer'),scrollheight={},isEmail=$footer.attr('data-isEmail'),isBrowser=($.browser.msie&&$.browser.version=='7.0')||($.browser.msie&&$.browser.version=='8.0'),element=document.documentElement,body=document.body,scrollY=document.all?(!element.scrollTop?body.scrollTop:element.scrollTop):(window.pageYOffset?window.pageYOffset:window.scrollY);if(isBrowser)scrollheight=isEmail?{topHeight:'80px',downHeight:'35px'}:{topHeight:'50px',downHeight:'5px'};else scrollheight=isEmail?{topHeight:'76px',downHeight:'31px'}:{topHeight:'46px',downHeight:'1px'};if(scrollY==0){$footer.slideUp('fast');$header.slideDown('fast');setTimeout('$(".jt-header-nav-interestCategory").css( { top : "'+scrollheight.topHeight+'" })',0)}else{$footer.slideDown('fast');$header.slideUp('fast',function(){$('.jt-header-nav-interestCategory').css({top:scrollheight.downHeight})})}}};jtown.home.clickShop=function(spn){$.postJSON(contextPath+'ajax/clickView.jt',{sellerPn:spn},function(){})};jtown.home.goHome=function(spn){$.postJSON(contextPath+'ajax/goHome.jt',{sellerPn:spn},function(){})};jtown.home.clickLove=function(spn){$.postJSON(contextPath+'ajax/clickLove.jt',{sellerPn:spn},function(count){var spn=count.sellerPn,crudType=count.crudType,message=count.message,$small=$('#jt-heart-click-'+spn),$big=$('#jt-heart-expand-click-'+spn);if(!nullValueCheck(message)){message=='1'?jtown.login.showLoginForm():jtown.dialog('판매자는 불가능합니다');return}if(crudType=='insert'){$small.addClass('jt-heart-animation');$big.addClass('jt-heart-animation')}else if(crudType=='delete'){$small.removeClass('jt-heart-animation');$big.removeClass('jt-heart-animation')}})};jtown.home.html=function(data){var jtownUsers=data.jtownUsers,images=data.images,newComments=data.newComments,browser=$.browser,isIe7=browser.msie&&browser.version=='7.0',htmlArray=[],html='';for(var i=0,len=jtownUsers.length;i<len;i++){var seller=jtownUsers[i],spn=seller.pn,mainImages=images[spn],comments=newComments[spn],imageHtml='',commentHtml='',msieHtml=(isIe7||(browser.msie&&browser.version=='8.0'))?'<div class="jt-home-shop-image-footer"></div>':'',hotHtml=!(nullValueCheck(seller.loveHotCount)||seller.loveHotCount==0)?'<span class="jt-home-shop-love-hot" title="최근 뜨는 미니샵">HOT</span>':'',loveClick=!nullValueCheck(seller.customerPn)?'jt-home-shop-love-click':'',loveTextClick=!nullValueCheck(seller.customerPn)?'jt-home-shop-love-text-click':'';if(mainImages.length==0){imageHtml='<img alt="Blank" src="'+contextPath+'resources/images/jt-introduce-home-blank.png" title="'+htmlChars(seller.name)+'"/>	'}else{for(var j=0,jLen=mainImages.length;j<jLen;j++){var mainImage=mainImages[j],imageSrc=contextPath+'resources/uploadImage/'+mainImage;imageHtml+='<img alt="" src="'+imageSrc+'" title="'+htmlChars(seller.name)+'"/>	'}}for(var j=0,jLen=comments.length;j<jLen;j++){var comment=comments[j];commentHtml+='<div class="jt-home-shop-comments" data-isSplit="'+comment.isSplit+'" data-copn="'+comment.commentPn+'">'+htmlChars(comment.splitHome);commentHtml+='</div>'}html+='	<div class="jt-home-shop" id="jt-home-shop-'+spn+'"  data-spn="'+spn+'">';html+='		<header>';html+='			<a href="'+seller.shopUrl+'" target="_blank" onclick="jtown.home.goHome(\''+spn+'\')">'+htmlChars(seller.name)+'</a>';html+='		</header>';html+='		<div class="jt-home-shop-content">';html+='			<ul class="jt-home-shop-content-image">';html+='				<li>';html+='					'+imageHtml;html+='					<div class="jt-home-shop-new-event">';html+='						<div id="new-product-'+spn+'" class="jt-home-shop-new-event-div" style="'+((seller.newProduct>0)?"display: block;":"display:none;")+'">';html+=' 							<span class="jt-home-shop-product-new-image">New arrive</span>';html+='						</div>';html+='						<div id="new-'+spn+'" class="jt-home-shop-new-event-div" style="'+(seller.newBanner?"display: block;":"display:none;")+'">';html+=' 							<span class="jt-home-shop-event-new-image">New event</span>';html+='						</div>';html+='					</div>';html+='				</li>';html+='			</ul>';html+='		</div>';html+='		<div class="jt-home-notice">';html+='			<span class="jt-home-shop-footer-firstQuotationMark">"</span>';html+='			<pre class="jt-home-shop-footer-text">'+htmlChars(seller.notice)+'</pre>';html+='			<span class="jt-home-shop-footer-lastQuotationMark">"</span>';html+='		</div>';html+='		<ul class="jt-home-shop-content-fn">';html+='			<li>';html+='				<span class="jt-home-shop-view" title="최근 일주일간 방문수">VIEW</span>&nbsp;<span id="view-'+spn+'">'+(nullValueCheck(seller.viewCount)?0:seller.viewCount)+'</span>';html+='			</li>';html+='			<li>';html+='				<span class="jt-home-shop-comment">COMMENT</span>&nbsp;<span id="comment-'+spn+'">'+(nullValueCheck(seller.commentCount)?0:seller.commentCount)+'</span>';html+='			</li>';html+='			<li>';html+='			<div class="jt-heart-click-wrap">';html+='				<div class="jt-heart-click-background" id="jt-heart-click-'+spn+'">';html+='					<img alt="heart-background" src="'+contextPath+'resources/images/heart-background.png">';html+='				</div>';html+='				<div class="jt-heart-click">';html+='				<a href="#none" onclick="jtown.home.clickLove(\''+spn+'\');"id="love-image-'+spn+'" class="jt-home-shop-love '+loveClick+'">♥</a>';html+='				</div>';html+='			</div>';html+='			<div class="jt-home-shop-content-love-text-wrap">';html+='				<span id="love-'+spn+'" class="'+loveTextClick+'">'+(nullValueCheck(seller.loveCount)?0:seller.loveCount)+'</span>';html+='				'+hotHtml;html+='			</div>';html+='			</li>';html+='		</ul>';if(comments.length>0){html+='		<div class="jt-home-shop-comments-wrap">';html+='			<div class="jt-home-shop-comments-bar"><div></div></div>';html+='			'+commentHtml;html+='		</div>'}html+='		'+msieHtml;html+='	</div>';if(!isIe7){htmlArray[i]=$(html).get(0);html=''}}return!isIe7?htmlArray:html};jtown.home.naturalLanguage=function(){$.widget("custom.catcomplete",$.ui.autocomplete,{_renderMenu:function(ul,items){var that=this,currentCategory="";$.each(items,function(index,item){if(item.category!=currentCategory){ul.append('<li class="ui-autocomplete-category"><span class="ui-autocomplete-category-span">'+item.category+'</span></li>');currentCategory=item.category}that._renderItem=function(ul,item){return $('<li>').append('<a class="ui-catcomplete-menu-item">'+item.label+'</a>').appendTo(ul)};that._renderItemData(ul,item)})}});$('#jt-naturalLanguage-search').catcomplete({source:function(request,response){var url=contextPath+'ajax/natural/autocomplete.jt',json={searchName:request.term};$.postJSON(url,json,function(map){var jtownUsers=map.jtownUsers,interests=map.interests,data=[];for(var i=0,len=jtownUsers.length;i<len;i++){var jtownUser=jtownUsers[i];data[i]={label:jtownUser.name,value:jtownUser.name,pn:jtownUser.pn,category:'SHOP'}}for(var i=0,len=interests.length,size=jtownUsers.length;i<len;i++){var interest=interests[i];data[i+size]={label:interest.name,value:interest.name,categoryPn:interest.categoryPn,spn:interest.sectionPn,category:'CATEGORY'}}response(data)})},minLength:1,select:function(event,ui){var item=ui.item;if(item.category=='SHOP'){location.href=contextPath+'mir/'+item.pn}else if(item.category=='CATEGORY'){location.href=contextPath+'cpn/'+item.categoryPn+'/spn/'+item.spn}},focus:function(event,ui){$('.ui-state-focus').removeClass('ui-corner-all').removeClass('ui-state-focus')},open:function(){$('.ui-autocomplete').removeClass('ui-widget-content').addClass('ui-catcomplete-content');$(this).addClass('ui-catcomplete-input');$('.ui-menu').css({padding:0})},close:function(){$(this).removeClass('ui-catcomplete-input');$('#jt-naturalLanguage-search').val('')}})};function htmlChars(character){if(nullValueCheck(character)){return""}var str=((character.replace('"','&amp;')).replace('"','&quot;')).replace('\'','&#39;');return(str.replace('<','&lt;')).replace('>','&gt;')}function nullValueCheck(object){if(object==null||object==undefined||object==''||object=='undefined'){return true}return false}function split(val){return val.split(/,\s*/)}var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)return data[i].identity}else if(dataProp)return data[i].identity}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};function checkKeycode(e){var keycode=0;if(window.event)keycode=window.event.keyCode;else if(e)keycode=e.which;if(keycode==116){keycode=2;location.href=realPath;return false}else if(e.ctrlKey&&(keycode==78||keycode==82)){location.href=realPath;return false}}if(typeof jtown.login=='undefined'){jtown.login={}}function onPopupLoginSubmit(){jtown.login.submit('jt-popup-login-form')}function onPageLoginSubmit(){jtown.login.submit('jt-page-login-form')}jtown.login.submit=function(name){var $form=$('#'+name);jQuery.ajax({'type':'POST','url':contextPath+'j_spring_security_check','data':$form.serialize(),'dataType':'text','success':function(data){jtown.login.control(data,name)}})};jtown.login.control=function(data,name){var map=eval('('+data+')'),result=map.result,url=map.url;if(result=='success'){location.href=contextPath+url}else if(result=='error'){location.href=contextPath+'login/?isFinish=0'}return};jtown.login.showLoginForm=function(){var inner=$('#jt-login-form-wrap'),form=inner.find('form[name=jt-popup-login-form]'),j_username=inner.find('input[name=j_username]'),j_password=inner.find('input[name=j_password]');form.attr('id','jt-popup-login-form');j_username.attr('id','j_username');j_password.attr('id','j_password');$.smartPop.open({width:430,height:350,html:inner.html(),effect:null});form.attr('id','');j_username.attr('id','');j_password.attr('id','');setTimeout('$(function() { $(\'#j_username, #j_password\').placeholder(); });',0)};jtown.login.resendEmailAddress=function(){$('#resendConfirmMail').unbind('click');jtown.postJSON(contextPath+'ajax/resendConfirmEmail.jt',{},function(){jtown.dialog('E-mail을 재전송 하였습니다.');$('#resendConfirmMail').bind('click',function(){jtown.login.resendEmailAddress()})})};jtown.login.joinFormSubmit=function(){$('.jt-join-submit').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['jtownUser'];form.submit()})};jtown.login.changeUserSubmit=function(){$('.jt-change-user-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['jtownUser'];form.action=contextPath+'login/modify.jt';form.submit()})};jtown.login.disactiveUser=function(){$('.jt-disactive-user-btn').toggle(function(){$('.jt-disactive-content').show();setTimeout("$('html, body').animate({scrollTop: $(document).height()}, 'slow')",0)},function(){$('.jt-disactive-content').slideUp()});$('.jt-disactive-btn').bind('click',function(){jtown.confirm('계정을 정말로 삭제하시겠습니까?',function(){var form=document.forms['disactiveUser'];form.submit()},function(){})});$('.jt-disactive-cancle-btn').bind('click',function(){jtown.confirm('계정 삭제를 취소하시겠습니까?',function(){var form=document.forms['disactiveUser'];form.submit()},function(){})})};jtown.login.confirmPassword=function(){$('input[name=confirmPassword]').keyup(function(){var cpw=$(this).val(),pw=nullValueCheck($('input[data-form=joinPw]').val())?$('input[data-form=modify]').val():$('input[data-form=joinPw]').val();if(cpw==pw){$('#confirmPW>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmPW>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){var cpw=$(this).val(),pw=nullValueCheck($('input[data-form=joinPw]').val())?$('input[data-form=modify]').val():$('input[data-form=joinPw]').val();if(cpw==pw){$('#confirmPW>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmPW>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}$('#confirmPW').show()}).blur(function(){$('#confirmPW').hide()})};if(typeof jtown.admin=='undefined'){jtown.admin={}}var oEditors=[];$(function(){$('#jt-search-partnership-btn').bind('click',function(){var form=document.forms['partnershipFilter'];form.page.value=1;form.submit()});var boardContent=$('#board #content');if(boardContent.html()!=undefined){nhn.husky.EZCreator.createInIFrame({oAppRef:oEditors,elPlaceHolder:"content",sSkinURI:contextPath+"resources/se2/SmartEditor2Skin.html",fCreator:"createSEditor2"})}$('#jt-admin-notice-delete').bind('click',function(){jtown.confirm('게시글을 삭제하시겠습니까?',function(){var form=document.forms['board'];form._method.value='delete';form.submit()},function(){})});jtown.admin.sellerCreate();jtown.admin.sellerSync();$('.jt-reset-password').unbind('click').bind('click',function(){var json={username:$(this).attr('data-username')},url=contextPath+'admin/ajax/resetPassword.jt';$.postJSON(url,json,function(){jtown.dialog('재설정 되었습니다.')})});$('.jt-partnership-table-information').unbind('click').bind('click',function(){var partnershipPn=$(this).parents('.jt-partnership-info').attr('data-pspn');$('#partnership-content-'+partnershipPn).toggle()});$('.jt-admin-customer-enable').unbind('change').bind('change',function(){var parents=$(this).parents('.jt-admin-customer-table-tr'),json={'pn':parents.attr('data-cpn'),'enabled':($(this).val()==1?true:false)},url=contextPath+'admin/ajax/changeEnabled.jt';$.postJSON(url,json,function(){})});jtown.admin.changeText('jt-partnership-name',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/updatePartnershipName.jt',json={pn:grandParent.attr('data-pspn'),name:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeText('jt-partnership-email',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/updatePartnershipEmail.jt',json={pn:grandParent.attr('data-pspn'),email:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeText('jt-partnership-phoneNumber',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/updatePartnershipPhoneNumber.jt',json={pn:grandParent.attr('data-pspn'),phoneNumber:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeSelect('jt-partnership-category',function(thiz,nameVo){success=function(){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/updatePartnershipCategory.jt',json={pn:grandParent.attr('data-pspn'),categoryPn:thiz.val()};$.postJSON(url,json,function(partnership){var pn=partnership.jtownUser.pn;if(pn!=null&&pn!=0){grandParent.find('.jt-partnership-interest').html('')}})};cancle=function(){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/selectPartnershipCategory.jt',json={pn:grandParent.attr('data-pspn')};$.postJSON(url,json,function(categoryPn){thiz.val(categoryPn)})};jtown.confirm('사업아이템을 바꾸시겠습니까?',success,cancle)});jtown.admin.changeSelect('jt-partnership-adminPn',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/changePartnershipJson.jt',json={key:grandParent.attr('data-pspn'),value:thiz.val()};$.postJSON(url,json,function(partnership){})});jtown.admin.changeSelect('jt-partnership-process',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/updatePartnership.jt',json={pn:grandParent.attr('data-pspn'),process:thiz.val()};$.postJSON(url,json,function(partnership){})});jtown.admin.changeSelect('jt-partnership-deposit',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/updatePartnership.jt',json={pn:grandParent.attr('data-pspn'),deposit:thiz.val()};$.postJSON(url,json,function(partnership){})});jtown.admin.changeTextarea('jt-partnership-note',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/updatePartnershipNote.jt',json={pn:grandParent.attr('data-pspn'),note:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html('<pre>'+htmlChars(object.value)+'</pre>')}})})});jtown.admin.sellerCreate=function(){$('.jt-seller-create-btn').unbind('click').bind('click',function(){var thiz=$(this),parent=thiz.parents('.jt-partnership-info'),pspn=parent.attr('data-pspn');var url=contextPath+'admin/ajax/createSeller.jt';var json={pn:pspn,shopUrl:thiz.attr('data-shopUrl'),name:thiz.attr('data-name')};$.postJSON(url,json,function(jtownUser){parent.attr('data-spn',jtownUser.pn);parent.find('.jt-seller-create').html('<a href="'+contextPath+'seller/'+jtownUser.pn+'">'+jtownUser.username+'</a>').removeClass('jt-seller-create').addClass('jt-partnership-username');parent.find('.jt-seller-shopPn').text(jtownUser.sixShopPn).removeClass('jt-seller-shopPn').addClass('jt-partnership-shopPn');parent.find('.jt-seller-shopUrl').addClass('jt-partnership-shopUrl').removeClass('jt-seller-shopUrl');parent.find('.jt-seller-name').addClass('jt-partnership-sellerName').removeClass('jt-seller-name');parent.find('.jt-seller-enabled').addClass('jt-partnership-enabled').removeClass('jt-seller-enabled');parent.find('.jt-partnership-enabled-select').css('display','block');parent.find('.jt-seller-interest').text('').addClass('jt-partnership-interest').removeClass('jt-seller-interest');parent.find('.jt-seller-date').text('').addClass('jt-partnership-contract-date').removeClass('jt-seller-date');var btn='<button type="button" class="jt-admin-contract jt-btn-white-small"><span class="btnText">조회</span></button>';parent.find('.jt-seller-register').html(btn).addClass('jt-partnership-contract-register').removeClass('jt-seller-register');setTimeout('jtown.admin.sellerSync()',0)})})};jtown.admin.sellerSync=function(){jtown.admin.changeText('jt-partnership-shopUrl',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/changeSellerShopUrl.jt',json={pn:grandParent.attr('data-spn'),shopUrl:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeText('jt-partnership-sellerName',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/changeSellerName.jt',json={pn:grandParent.attr('data-spn'),name:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeText('jt-partnership-interest',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/changeInterest.jt',category=grandParent.find('.jt-partnership-category-select'),json={sellerPn:grandParent.attr('data-spn'),categoryPn:category.val(),interestSectionList:thiz.val()};$.postJSON(url,json,function(){parent.html(htmlChars(thiz.val()))})},jtown.admin.autoInterestOne);jtown.admin.changeSelect('jt-partnership-enabled',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/changeEnabled.jt',json={pn:grandParent.attr('data-spn'),enabled:(thiz.val()==1?true:false)};$.postJSON(url,json,function(jtownUser){})});$('.jt-admin-contract').unbind('click').bind('click',function(){var parent=$(this).parents('.jt-partnership-info'),spn=parent.attr('data-spn');var url=contextPath+'admin/contract/?sellerPn='+spn;var option='width=800, height=300, resizable=no, scrollbars=no, status=no';window.open(url,'',option)})};jtown.admin.changeText=function(name,callback,event){var eventString=$.browser.chrome?'keydown':'keypress';var nameVo={selector:'.'+name,input:name+'-input',inputSelector:'#'+name+'-input',parentSelector:'.jt-partnership-info'};$(nameVo.selector).unbind('mouseup').bind('mouseup',function(){var me=$(this),value=me.text(),html='<input class="" id="'+nameVo.input+'" type="text" value="'+value+'" style="width: '+(Number(me.width())-14)+'px;"/>';me.html(html);setTimeout(event,0);$(nameVo.inputSelector).focus();$(nameVo.inputSelector).bind('focusout',function(){callback($(this),nameVo)});$(nameVo.inputSelector).bind(eventString,function(event){if(event.keyCode==13){callback($(this),nameVo)}else if(event.keyCode==27){me.html(htmlChars(value))}})})};jtown.admin.changeSelect=function(name,callback){var nameVo={selector:'.'+name,input:name+'-select',inputSelector:'.'+name+'-select',parentSelector:'.jt-partnership-info'};$(nameVo.inputSelector).unbind('change').bind('change',function(){callback($(this),nameVo)})};jtown.admin.changeTextarea=function(name,callback,event){var eventString=$.browser.chrome?'keydown':'keypress';var nameVo={selector:'.'+name,input:name+'-input',inputSelector:'#'+name+'-input',parentSelector:'.jt-partnership-info'};$(nameVo.selector).unbind('mouseup').bind('mouseup',function(){var me=$(this),value=me.text(),html='<textarea class="" id="'+nameVo.input+'" type="text" style="width: '+(Number(me.width())-14)+'px; height: '+(Number(me.height()))+'">'+value+'</textarea>';me.html(html);setTimeout(event,0);$(nameVo.inputSelector).focus();$(nameVo.inputSelector).bind('focusout',function(){callback($(this),nameVo)});$(nameVo.inputSelector).bind(eventString,function(event){if(event.keyCode==13){callback($(this),nameVo)}else if(event.keyCode==27){me.html('<pre>'+htmlChars(value)+'</pre>')}})})};jtown.admin.autoInterestOne=function(){var eventString=$.browser.chrome?'keydown':'keypress';var categoryPn='';$('#jt-partnership-interest-input').unbind(eventString).bind(eventString,function(event){if(event.keyCode===$.ui.keyCode.TAB&&$(this).data('ui-autocomplete').menu.active){event.preventDefault()}if(categoryPn==''){var parent=$(this).parents('.jt-partnership-info');categoryPn=parent.find('.jt-partnership-category-select').val()}}).autocomplete({minLength:0,source:function(request,response){var url=contextPath+'admin/ajax/autoInterestSection.jt',json={'categoryPn':categoryPn,'name':request.term};$.postJSON(url,json,function(interestes){var data=[];for(var i=0,len=interestes.length;i<len;i++){var interest=interestes[i];data[i]={label:interest.name,value:interest.name}}response(data)})},focus:function(){return false},select:function(event,ui){var terms=split(this.value);terms.pop();terms.push(ui.item.value);terms.push('');this.value=terms.join(',');return false}})};if(typeof jtown.seller=='undefined'){jtown.seller={}}$(function(){jtown.seller.syncPopup();jtown.seller.startIntro();jtown.seller.markIntro();jtown.seller.syncIntro();jtown.seller.syncMainNotice();jtown.seller.syncMainImage();jtown.seller.syncProduct();jtown.seller.syncEvent();jtown.seller.syncExpandNotice();$('#jt-event-second-image').uploadify({'formData':{'pn':$('#jt-seller-body').attr('data-spn')},'buttonText':'사진 업로드','fileTypeDesc':'Image Files','fileTypeExts':'*.gif; *.jpg; *.png','fileSizeLimit':'2MB','multi':false,'swf':contextPath+'resources/uploadify/uploadify.swf','uploader':contextPath+'file/upload.jt','itemTemplate':'<div></div>','onUploadSuccess':function(file,data,response){jtown.seller.secondEvent(eval('('+data+')'))}});$('#jt-event-first-image').uploadify({'formData':{'pn':$('#jt-seller-body').attr('data-spn')},'buttonText':'사진 업로드','fileTypeDesc':'Image Files','fileTypeExts':'*.gif; *.jpg; *.png','fileSizeLimit':'2MB','multi':false,'swf':contextPath+'resources/uploadify/uploadify.swf','uploader':contextPath+'file/upload.jt','itemTemplate':'<div></div>','onUploadSuccess':function(file,data,response){jtown.seller.firstEvent(eval('('+data+')'))}});$('#jt-represent-image').uploadify({'formData':{'pn':$('#jt-seller-body').attr('data-spn')},'buttonText':'사진 업로드','method':'post','fileTypeDesc':'Image Files','fileTypeExts':'*.gif; *.jpg; *.png','fileSizeLimit':'2MB','multi':false,'swf':contextPath+'resources/uploadify/uploadify.swf','uploader':contextPath+'file/upload.jt','itemTemplate':'<div></div>','onUploadSuccess':function(file,data,response){jtown.seller.mainImage(eval('('+data+')'))}});$('#jt-product-file').uploadify({'formData':{'pn':$('body').attr('data-spn')},'buttonClass':'uploadify-plus-insert-btn','buttonText':'<img src="'+contextPath+'resources/images/jt-cloth-icon.png'+'" style="float:left; margin:9px 7px 0 10px"/><span style="float:left; ">상품추가</span>','height':'30','width':'90','fileTypeDesc':'Image Files','fileTypeExts':'*.gif; *.jpg; *.png','fileSizeLimit':'2MB','swf':contextPath+'resources/uploadify/uploadify.swf','uploader':contextPath+'file/upload.jt','itemTemplate':'<div></div>','errorMsg':'','onUploadSuccess':function(file,data,response){jtown.seller.productImage(eval('('+data+')'))}});$('#jt-product-finish').unbind('click').bind('click',function(){window.opener.document.location.reload();window.close()});$('#jt-tag-update-show-btn').toggle(function(){var url=contextPath+'ajax/seller/selectInterestes.jt',json={};$.postJSON(url,json,function(interestes){var html='';for(var i=0,iLen=interestes.length;i<iLen;i++){var interest=interestes[i];var checked=nullValueCheck(interest.sellerPn)?'':'checked="checked"';html+='<li><input type="checkbox" '+checked+' name="jt-tag-check" class="jt-tag-check" value="'+interest.sectionPn+'"/><label for="jt-tag-check">'+htmlChars(interest.name)+'</label></li>'}$('#jt-tag-checkBox-section>ul').html(html);$('#jt-tag-checkBox').show();setTimeout('jtown.seller.changeTag()',0);setTimeout('jtown.seller.changeTagIntro();',0)})},function(){$('#jt-tag-checkBox').hide();setTimeout('jtown.seller.changeTagIntro();',0)})});jtown.seller.changeTag=function(){$('.jt-tag-check').unbind('click').bind('click',function(){var checkedList=$('input:checkbox[name=jt-tag-check]:checked');if(checkedList.length>5){$(this).each(function(){this.checked=false});$('#jt-checkBox-header-text').css('color','#ff3600')}else{$('#jt-checkBox-header-text').css('color','#808080')}});$('#jt-tag-update-btn').unbind('click').bind('click',function(){var checkedList=$('input:checkbox[name=jt-tag-check]:checked');var spnList=new Array(checkedList.length);for(var i=0,cLen=checkedList.length;i<cLen;i++){var checked=checkedList[i];spnList[i]=checked.value}var url=contextPath+'ajax/seller/updateSellerInterestes.jt';var json={spnList:spnList};$.postJSON(url,json,function(interestes){$('#jt-seller-tag-content>span').remove();var html='';for(var i=0,iLen=interestes.length;i<iLen;i++){var interest=interestes[i];html+='<span>'+interest.name;if((i+1)!=iLen){html+=', '}html+='</span>'}$('#jt-tag-update-show-btn').before(html);$('#jt-tag-checkBox').hide();setTimeout('jtown.seller.changeTagIntro();',0)})});$('#jt-tag-cancle-btn').unbind('click').bind('click',function(){$('#jt-tag-checkBox').hide();setTimeout('jtown.seller.changeTagIntro();',0)})};jtown.seller.changeTagIntro=function(){var height=Number($('#step2').height())+20;$('.introjs-helperLayer').height(height)};makeIntro=function(){var intro=introJs();intro.setOptions({steps:[{element:'#step1',intro:'ShopNo : 고객고유번호<br/> Seller : 회사명 <br/>Site : 홈페이지주소<br/>'+'<span style="color : #ff431e;">위 정보는 고유정보 임으로 바꾸시려면 <a href="'+contextPath+'help/question" style="text-decoration:underline; color:#ff431e;">고객센터</a>에 문의 해주시기 바랍니다.</span>'},{element:'#step2',intro:'<ol>'+'	<li>쇼핑몰 대표 태그 입니다.</li>'+'	<li><span class="jt-intro-order">1.</span><span class="jt-tag-update-intro">수정</span> 을 클릭합니다.</li>'+'	<li><span class="jt-intro-order">2.</span>자신이 원하는 Tag을 체크합니다.</li>'+'	<li><span class="jt-intro-order">3.</span>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#step3',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 사진 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>사진 업로드 버튼을 클릭하여 사진을 업로드 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#jt-seller-main-footer',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 내용 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>내용을 수정 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#step5',intro:'<ul>'+'	<li><span class="jt-home-shop-view jt-home-text-explain">VIEW</span> : 최근 일주일간 방문수</li>'+'	<li><span class="jt-home-shop-comment jt-home-text-explain jt-comment-text-explain">COMMENT</span> : 댓글 수</li>'+'	<li><span class="jt-home-shop-love jt-home-text-explain jt-love-text-explain">♥</span> : 하트 클릭 수</li>'+'</ul>'},{element:'#jt-home-expand-shop-notice',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 내용 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>내용을 수정 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#step7',intro:'소비자가 해당 상품을 클릭하면 입력된 상품 URL 로 이동됩니다. 입력되지 않았을 시에는 쇼핑몰 첫 페이지로 이동 됩니다. 입력은 다음 단계에서 간편하게 가능 합니다.'},{element:'#step8',intro:'\'+\' 버튼을 누르시고 당신의 상품을 알려보세요.'},{element:'#jt-seller-expand-event-first',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 사진 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>사진 업로드 버튼을 클릭하여 사진을 업로드 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#jt-seller-expand-event-second',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 사진 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>사진 업로드 버튼을 클릭하여 사진을 업로드 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'}]});return intro};jtown.seller.syncIntro=function(){$('.jt-seller-text-content').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}});$('.jt-home-shop-content-fn').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}});$('.jt-home-expand-seller-fake').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}});$('.jt-home-expand-shop-products').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}});$('.jt-seller-tag').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}})};jtown.seller.startIntro=function(){$('#showHow').unbind('click').bind('click',function(){makeIntro().start()});$('#showHowPopup').unbind('click').bind('click',function(){makePoupIntro().start()})};jtown.seller.markIntro=function(){$('.question-mark').unbind('click').bind('click',function(){$('.question-mark').addClass('question-mark-hide');var step=$(this).attr('data-step');makeIntro().goToStep(step).start().oncomplete(function(){jtown.seller.markIntro();$('.question-mark').removeClass('question-mark-hide')}).onexit(function(){jtown.seller.markIntro();$('.question-mark').removeClass('question-mark-hide')})})};jtown.seller.syncProduct=function(){$('.jt-home-expand-shop-expandProduct').unbind('mouseover mouseout');$('.jt-home-expand-shop-expandProduct').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.jt-product-article-object-wrap').show()}else if(event.type=='mouseout'){$(this).find('.jt-product-article-object-wrap').hide()}});$('#jt-product-popup').unbind('click').bind('click',function(){var url=contextPath+'seller/products/'+$(this).attr('data-pn');var option='width=610, height=530, toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=no';window.open(url,'',option)})};jtown.seller.syncPopup=function(){$('.jt-product-article-object-img').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).children('.jt-seller-expand-product-delete-tool').show();$(this).children('.jt-product-article-object-wrap').show()}else if(event.type=='mouseout'){$(this).children('.jt-seller-expand-product-delete-tool').hide();$(this).children('.jt-product-article-object-wrap').hide()}});$('.jt-seller-product-delete').unbind('click');$('.jt-seller-product-delete').bind('click',function(){var pn=$(this).parents('li').attr('data-ppn');var form=document.forms['product'];form.pn.value=pn;form._method.value='delete';form.submit()});$('.jt-product-article-object-img').unbind('click').bind('click',function(){var active=$(this).hasClass('jt-product-active');if(active){$('.jt-product-article-update').hide();$('.jt-product-article-insert').show();$('.jt-product-article-object-img').removeClass('jt-product-active');return}var pn=$(this).attr('data-ppn'),name=$(this).attr('data-name'),price=$(this).attr('data-price'),url=$(this).attr('data-url');var form=document.forms['product'];form.pn.value=pn;form.name.value=nullValueCheck(name)?'':name;form.price.value=nullValueCheck(price)?'':price;form.url.value=nullValueCheck(url)?'':url;$('.jt-product-article-insert').hide();$('.jt-product-article-update').show();$('.jt-product-input-error').addClass('jt-product-input').removeClass('jt-product-input-error');$('.jt-product-error').text('');$('.jt-product-article-object-img').removeClass('jt-product-active');$(this).addClass('jt-product-active')});$('.jt-product-update-cancle').unbind('click').bind('click',function(){$('.jt-product-article-update').hide();$('.jt-product-article-insert').show();$('.jt-product-article-object-img').removeClass('jt-product-active')});$('.jt-product-update-submit').unbind('click').bind('click',function(){var form=document.forms['product'];form._method.value='put';form.submit();$('.jt-product-article-update').hide();$('.jt-product-article-insert').show();$('.jt-product-article-object-img').removeClass('jt-product-active')})};jtown.seller.changeExpandTextIntro=function(){var height=Number($('#jt-home-expand-shop-notice').height())+20;$('.introjs-helperLayer').height(height)};jtown.seller.syncExpandNotice=function(){$('#jt-home-expand-shop-notice').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){var display=$('#jt-seller-expand-notice-update-tool').css('display');if(display=='none'){if(event.type=='mouseover'){$('#jt-seller-expand-notice-hover-tool').show();$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$('#jt-seller-expand-notice-hover-tool').hide();$(this).find('.question-mark-wrap').hide()}}});$('#jt-seller-expand-notice-updateShow').unbind('click').bind('click',function(){$('#jt-seller-expand-notice-hover-tool').hide();$('#jt-seller-expand-shop-text').hide();$('#jt-seller-expand-notice-update-tool').show();$('#jt-seller-expand-textarea').show();setTimeout('jtown.seller.changeExpandTextIntro();',0)});$('#jt-seller-expand-notice-update').unbind('click').bind('click',function(){$('#jt-seller-expand-notice-update-tool').hide();var url=contextPath+'ajax/seller/changeLongNotice.jt',longNotice=$('#jt-seller-expand-textarea').val(),json={'longNotice':longNotice};$.postJSON(url,json,function(){return jQuery.ajax({'success':function(){$('#jt-seller-expand-textarea').hide();$('#jt-seller-expand-shop-text').html(longNotice).show();setTimeout('jtown.seller.changeExpandTextIntro();',0)},'error':function(){$('#jt-seller-expand-textarea').hide();$('#jt-seller-expand-shop-text').show();setTimeout('jtown.seller.changeExpandTextIntro();',0);jtown.dialog('오류발생')}})})});$('#jt-seller-expand-notice-cancle').unbind('click').bind('click',function(){$('#jt-seller-expand-notice-update-tool').hide();$('#jt-seller-expand-textarea').hide().val($('#jt-seller-expand-shop-text').html());$('#jt-seller-expand-shop-text').show();setTimeout('jtown.seller.changeExpandTextIntro();',0)})};jtown.seller.changeMainTextIntro=function(){var height=Number($('#jt-seller-main-footer').height())+20;$('.introjs-helperLayer').height(height)};jtown.seller.syncMainNotice=function(){$('#jt-seller-main-footer').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){var display=$('#jt-seller-main-notice-update-tool').css('display');if(display=='none'){if(event.type=='mouseover'){$('#jt-seller-main-notice-hover-tool').show();$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$('#jt-seller-main-notice-hover-tool').hide();$(this).find('.question-mark-wrap').hide()}}});$('#jt-seller-main-notice-updateShow').unbind('click').bind('click',function(){$('#jt-seller-main-notice-hover-tool').hide();$('#jt-seller-main-footer-text').hide();$('#jt-seller-main-notice-update-tool').show();$('#jt-seller-main-textarea').show();setTimeout('jtown.seller.changeMainTextIntro()')});$('#jt-seller-main-notice-update').unbind('click').bind('click',function(){$('#jt-seller-main-notice-update-tool').hide();var url=contextPath+'ajax/seller/changeNotice.jt',notice=$('#jt-seller-main-textarea').val(),json={'notice':notice};$.postJSON(url,json,function(){return jQuery.ajax({'success':function(){$('#jt-seller-main-textarea').hide();$('#jt-seller-main-footer-text').html(notice).show();setTimeout('jtown.seller.changeMainTextIntro()')},'error':function(){$('#jt-seller-main-textarea').hide();$('#jt-seller-main-footer-text').show();setTimeout('jtown.seller.changeMainTextIntro()');jtown.dialog('오류발생')}})})});$('#jt-seller-main-notice-cancle').unbind('click').bind('click',function(){$('#jt-seller-main-notice-update-tool').hide();$('#jt-seller-main-textarea').hide().val($('#jt-seller-main-footer-text').html());$('#jt-seller-main-footer-text').show();setTimeout('jtown.seller.changeMainTextIntro()')})};jtown.seller.syncMainImage=function(){$('#jt-seller-main-image').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){var display=$('#jt-seller-main-image-update-tool').css('display');if(display=='none'){if(event.type=='mouseover'){$('#jt-seller-main-image-hover-tool').show();$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$('#jt-seller-main-image-hover-tool').hide();$(this).find('.question-mark-wrap').hide()}}});$('#jt-seller-main-image-updateShow').unbind('click').bind('click',function(){$('#jt-seller-main-image-hover-tool').hide();$('#jt-seller-main-image-update-tool').show();setTimeout('jtown.seller.changeMainBgHeight()',0)});$('#jt-seller-main-image-update').unbind('click').bind('click',function(){$('#jt-seller-main-image-update-tool').hide();jtown.seller.mainImageUpdate()});$('#jt-seller-main-image-cancle').unbind('click').bind('click',function(){$('#jt-seller-main-image-update-tool').hide();jtown.seller.mainImageCancle();setTimeout('jtown.seller.changeMainBgHeight()',0)})};jtown.seller.changeMainBgHeight=function(){var height=$('#jt-seller-main-image').height();$('#jt-seller-main-image-update-tool').height(height);height=Number(height)+20;$('.introjs-helperLayer').height(height)};jtown.seller.mainImage=function(file){var oldSrc=$('#jt-seller-main-image-area').attr('src'),newSrc=contextPath+'resources/uploadImage/'+file.saveName,oldSrcObject=$('#jt-seller-main-image-area').attr('data-oldSrc');$('#jt-seller-main-image-area').attr('src',newSrc).attr('data-imagePn',file.imagePn);if(nullValueCheck(oldSrcObject)){$('#jt-seller-main-image-area').attr('data-oldSrc',oldSrc)}setTimeout('jtown.seller.changeMainBgHeight()',100)};jtown.seller.mainImageUpdate=function(){var url=contextPath+'ajax/seller/changeMainImage.jt',json={'imagePn':$('#jt-seller-main-image-area').attr('data-imagePn')};$.postJSON(url,json,function(){return jQuery.ajax({'success':function(){$('#jt-seller-main-image-area').attr('data-oldSrc','').attr('data-imagePn','')},'error':function(){jtown.dialog("오류 발생!")}})})};jtown.seller.mainImageCancle=function(){var oldSrc=$('#jt-seller-main-image-area').attr('data-oldSrc');$('#jt-seller-main-image-area').attr('src',oldSrc).attr('data-oldSrc','').attr('data-imagePn','');$('#representImageForm #filedata').val('')};jtown.seller.productImage=function(file){var url=contextPath+'ajax/seller/insertProduct.jt',json={'imagePn':file.imagePn,'saveName':file.saveName};$.postJSON(url,json,function(product){if(product.count>19){jtown.dialog('상품은 20개 이하로 등록 가능합니다.')}if(product.count>9){$('.jt-photo-page-after').show()}else{$('.jt-photo-page-after').hide()}var me=$('#jt-product-article-object-'+product.count);me.children('img').attr('src',contextPath+'resources/uploadImage/'+product.saveName);me.addClass('jt-product-article-object-img');me.attr('data-ppn',product.pn);jtown.seller.syncPopup()})};jtown.seller.syncEvent=function(){$('#jt-seller-expand-event-first, #jt-seller-expand-event-second').unbind('mouseover mouseout');$('#jt-seller-expand-event-first, #jt-seller-expand-event-second').bind('mouseover mouseout',function(event){if($(this).children('.jt-home-expand-shop-event-update-wrap').css('display')=='none'){if(event.type=='mouseover'){$(this).children('.jt-home-expand-shop-event-tool').show();$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).children('.jt-home-expand-shop-event-tool').hide();$(this).find('.question-mark-wrap').hide()}}});$('.jt-home-expand-shop-event-tool').unbind('click').bind('click',function(){$(this).parents('.jt-home-expand-shop-event').children('.jt-home-expand-shop-event-tool').hide();$(this).parents('.jt-home-expand-shop-event').children('.jt-home-expand-shop-event-update-wrap').show()});$('.jt-home-expand-shop-event-update-cancle').unbind('click').bind('click',function(){var $parent=$(this).parents('.jt-home-expand-shop-event');var $img=$parent.find('img');var oldSrc=$img.attr('data-oldSrc');$img.attr('src',oldSrc).attr('data-oldSrc','').attr('data-imagePn','');$parent.find('input[type=file]').val('');$parent.children('.jt-home-expand-shop-event-update-wrap').hide()});$('.jt-home-expand-shop-event-update-done').unbind('click').bind('click',function(){var $parent=$(this).parents('.jt-home-expand-shop-event');var $img=$parent.find('img'),imagePn=$img.attr('data-imagePn');if(!nullValueCheck(imagePn)){var url=contextPath+'ajax/seller/changeEvent.jt',json={'imagePn':imagePn,'pn':$parent.attr('data-epn'),'bannerOrder':$parent.attr('data-bo')};$.postJSON(url,json,function(event){$img.attr('data-oldSrc','').attr('data-imagePn','');$parent.attr('data-epn',event.pn);$parent.children('.jt-home-expand-shop-event-update-wrap').hide();var html='<div class="jt-home-expand-shop-event-new">'+'<div>'+'<span class="jt-home-expand-shop-event-new-image">NEW</span>'+'</div>'+'</div>';$parent.prepend(html)})}else{$img.attr('data-oldSrc','').attr('data-imagePn','');$parent.children('.jt-home-expand-shop-event-update-wrap').hide()}})};jtown.seller.firstEvent=function(file){var oldSrc=$('#jt-seller-expand-event-first-img').attr('src'),newSrc=contextPath+'resources/uploadImage/'+file.saveName,oldSrcObject=$('#jt-seller-expand-event-first-img').attr('data-oldSrc');$('#jt-seller-expand-event-first-img').attr('src',newSrc).attr('data-imagePn',file.imagePn);if(nullValueCheck(oldSrcObject)){$('#jt-seller-expand-event-first-img').attr('data-oldSrc',oldSrc)}};jtown.seller.secondEvent=function(file){var oldSrc=$('#jt-seller-expand-event-second-img').attr('src'),newSrc=contextPath+'resources/uploadImage/'+file.saveName,oldSrcObject=$('#jt-seller-expand-event-second-img').attr('data-oldSrc');$('#jt-seller-expand-event-second-img').attr('src',newSrc).attr('data-imagePn',file.imagePn);if(nullValueCheck(oldSrcObject)){$('#jt-seller-expand-event-second-img').attr('data-oldSrc',oldSrc)}};if(typeof jtown.expand=='undefined'){jtown.expand={}}jtown.expand.show=true;jtown.expand.loadExpandShop=function(){$('.jt-home-shop-content-image').unbind('click').bind('click',function(){var parent=$(this).parents('.jt-seller-main');if(nullValueCheck(parent.html())){var jtHomeShop=$(this).parents('.jt-home-shop'),spn=jtHomeShop.attr('data-spn');jtown.expand.makeInnerHtml(spn)}});$('.jt-home-shop-comment').unbind('click').bind('click',function(){var $parent=$(this).parents('.jt-seller-main');if(nullValueCheck($parent.html())){var jtHomeShop=$(this).parents('.jt-home-shop'),spn=jtHomeShop.attr('data-spn');jtown.expand.makeInnerHtml(spn)}})};jtown.expand.makeInnerHtml=function(spn){var url=contextPath+'ajax/home/expandShop.jt',json={'pn':spn};$.postJSON(url,json,function(selectMap){var html='';var path=contextPath+'resources/uploadImage/';var event1=selectMap.event1,event2=selectMap.event2,products=selectMap.products,jtownUser=selectMap.jtownUser,comments=selectMap.comments,commentTops=selectMap.commentTops,commentFilter=selectMap.commentFilter,interests=selectMap.interestes,cpn=selectMap.cpn,best=false,loveHave=selectMap.loveHave;var productSize=Number(products.length);var bigProductHtml='';var smallProductHtml='';for(var i=0;i<productSize;i++){var product=products[i];var detailProduct='<span>'+htmlChars(nullValueCheck(product.name)?'':product.name)+'</span>';detailProduct+='<span>'+htmlChars(nullValueCheck(product.commaPrice)?'':product.commaPrice)+'</span>';if(nullValueCheck(product.name)||nullValueCheck(product.commaPrice)){detailProduct='<span>상품 정보가 아직</span><span>입력되지 않았습니다.</span>'}bigProductHtml+='	<li class="jt-home-expand-shop-expandProduct">';bigProductHtml+='		<a href="'+(nullValueCheck(product.url)?jtownUser.shopUrl:product.url)+'" target="_blank" onclick="jtown.home.goHome('+spn+');"><img alt="상품" src="'+path+product.saveName+'"/></a>';bigProductHtml+='		<div class="jt-product-article-object-wrap jt-product-article-object-expand">';bigProductHtml+='			'+detailProduct;bigProductHtml+='		</div>';bigProductHtml+='	</li>';var smallProductNewHtml='<span class="text">&nbsp;</span>';if(product.newProduct){smallProductNewHtml='<span class="text">New</span>'}smallProductHtml+='<div class="thumbnail">';smallProductHtml+='	'+smallProductNewHtml;smallProductHtml+='	<span class="'+i+' image" ><img alt="Product'+i+'" src="'+path+product.saveName+'"/></span>';smallProductHtml+='</div>'}if(productSize<3){for(var i=productSize;i<3;i++){bigProductHtml+='	<li class="jt-home-expand-shop-expandProduct">';bigProductHtml+='		<a href="'+jtownUser.shopUrl+'"><img alt="Empty Product" src="'+contextPath+'resources/images/jt-product-blank.png"></a>';bigProductHtml+=' </li>';smallProductHtml+='<div class="thumbnail">';smallProductHtml+='	<span class="text">&nbsp;</span>';smallProductHtml+='	<span class="image" ><img alt="Product" src="'+contextPath+'resources/images/jt-product-thumbnail-blank.png"/></span>';smallProductHtml+='</div>'}}var eventImage1=contextPath+'resources/images/jt-event-user-blank.png',eventImage2=contextPath+'resources/images/jt-event-user-blank.png';if(!nullValueCheck(event1)){eventImage1=path+event1.saveName}if(!nullValueCheck(event2)){eventImage2=path+event2.saveName}var commentHtml='';if(commentTops.length>0){comments=commentTops;best=true}var cancleHtml='&nbsp;<a href="#none" class="jt-home-expand-shop-comment-loveIt-cancle">취소</a>';for(var i=0;i<comments.length;i++){var comment=comments[i];var cancleComment=nullValueCheck(comment.commentCustomerPn)?'':cancleHtml;var warnComment='';if(comment.customerPn!=cpn){if(nullValueCheck(comment.warnCustomerPn)){warnComment='&nbsp;<span href="#none" class="jt-warn-active" title="신고">WARN</span>'}else{warnComment='&nbsp;<span href="#none" class="jt-warn-disactive" title="신고">WARN</span>'}}commentHtml+='<li data-copn="'+comment.commentPn+'" class="'+(best?'jt-home-expand-shop-comment-li-best':'jt-home-expand-shop-comment-li')+'">';commentHtml+='	<ul class="jt-home-expand-shop-text-wrap">';if(best){commentHtml+='		<li class="jt-home-expand-shop-comment-header">';commentHtml+='			<span class="jt-home-expand-shop-comment-best">BEST</span>';commentHtml+='		</li>'}commentHtml+='		<li class="jt-home-expand-shop-comment-content">';commentHtml+='			<span class="jt-home-expand-shop-comment-name">'+htmlChars(comment.customerName)+'</span>';commentHtml+=' 			<span class="jt-home-expand-shop-comment-text">'+htmlChars(comment.comment)+'</span>';commentHtml+='		</li>';commentHtml+='		<li class="copnLoveIt-'+comment.commentPn+' jt-home-expand-shop-comment-footer">';commentHtml+='			<span class="jt-home-expand-shop-comment-progress-date">'+comment.inputDate+'</span>';commentHtml+=' 			<a href="#none" class="jt-home-expand-shop-comment-loveIt">LOVE</a>';commentHtml+='			<span class="jt-home-expand-shop-comment-loveIt-count">'+(nullValueCheck(comment.commentLoveCount)?'':comment.commentLoveCount)+'</span>'+cancleComment;commentHtml+='			'+warnComment;commentHtml+='		</li>';commentHtml+='	</ul>';if(comment.customerPn==cpn){commentHtml+='<div class="jt-home-expand-shop-update-wrap">';commentHtml+='	<input type="text" class="jt-comment-update-input" value="'+htmlChars(comment.comment)+'" maxlength="100"><br/>';commentHtml+='	<span>esc를 누르시면 수정이 취소 됩니다.</span>';commentHtml+='</div>';commentHtml+='<div class="jt-home-expand-shop-tool-wrap">';commentHtml+='	<a href="#none" class="jt-comment-update jt-btn-white-small">';commentHtml+='		<span class="btnImage"></span>';commentHtml+='	</a>';commentHtml+='	<a href="#none" class="jt-comment-delete jt-btn-white-small">';commentHtml+='		<span class="btnImage"></span>';commentHtml+='	</a>';commentHtml+='</div>'}commentHtml+='</li>'}var pagination=commentFilter.pagination;if(commentTops.length>0){if(pagination.numItems>0){commentHtml+='<li class="jt-home-expand-shop-comment-add">';commentHtml+='	<a href="#none" class="jt-btn-silver" id="comment-add-btn"';commentHtml+='		data-spn="'+jtownUser.pn+'" data-page="0" ';commentHtml+='		data-ni="'+pagination.numItems+'" data-nipp="'+pagination.numItemsPerPage+'">';commentHtml+='			댓글&nbsp;더&nbsp;보기&nbsp;<span id="comment-now-count">0</span>/'+pagination.numItems;commentHtml+='	</a>';commentHtml+='</li>'}}else{if(pagination.numItems>pagination.numItemsPerPage){commentHtml+='<li class="jt-home-expand-shop-comment-add">';commentHtml+='	<a href="#none" class="jt-btn-silver" id="comment-add-btn"';commentHtml+='		data-spn="'+jtownUser.pn+'" data-page="1" ';commentHtml+='		data-ni="'+pagination.numItems+'" data-nipp="'+pagination.numItemsPerPage+'">';commentHtml+='			댓글&nbsp;더&nbsp;보기&nbsp;<span id="comment-now-count">'+pagination.numItemsPerPage+'</span>/'+pagination.numItems;commentHtml+='	</a>';commentHtml+='</li>'}}var commentInputHtml='';if(cpn==0){commentInputHtml+='<input id="jt-comment-insert" readonly="readonly" placeholder="판매자 아이디로는 이용하실 수 없습니다."/>'}else if(!nullValueCheck(cpn)){commentInputHtml+='<input type="text" id="jt-comment-insert" placeholder="쇼핑몰에 대한 한마디를 남겨보세요. 상품 배송문의는 해당 쇼핑몰 고객센터로 남겨주세요." maxlength="100"/>'}else{commentInputHtml+='<input id="jt-comment-insert" readonly="readonly" placeholder="로그인한 사용자만 사용할 수 있습니다."/>'}var newEventHtml='';newEventHtml+='		<div class="jt-home-expand-shop-event-new">';newEventHtml+='			<div>';newEventHtml+='				<span class="jt-home-expand-shop-event-new-image">NEW</span>';newEventHtml+='			</div>';newEventHtml+='		</div>';var loveClick=(!nullValueCheck(loveHave)&&loveHave!=0)?'jt-home-shop-love-click':'';var loveTextClick=(!nullValueCheck(loveHave)&&loveHave!=0)?'jt-home-shop-love-text-click':'';var loveHotCount='<span class="jt-home-shop-love-hot" title="최근 뜨는 미니샵">HOT</span>';if(nullValueCheck(jtownUser.loveHotCount)||jtownUser.loveHotCount==0){loveHotCount=''}var tagHtml='<div style="padding-bottom: 15px; float:left; width: 100%;"></div>';if(interests.length>0){tagHtml+='<div class="jt-home-expand-shop-tag">';tagHtml+='<span class="tag-txt">';for(var i=0,iLength=interests.length;i<iLength;i++){var interest=interests[i];tagHtml+=interest.name;if((i+1)!=iLength){tagHtml+=',&nbsp;'}}tagHtml+='</span><span class="tag-image">Tag</span>';tagHtml+='</div>'}html+='<header class="jt-home-expand-click-shop-header">';html+='	<div>';html+='		<a href="'+jtownUser.shopUrl+'" target="_blank" onclick="jtown.home.goHome(\''+spn+'\');" title="클릭시 해당 쇼핑몰로 이동됩니다.">'+htmlChars(jtownUser.name)+'</a>';html+='	</div>';html+='</header>';html+='<div class="jt-home-expand-shop jt-home-expand-click-shop" id="jt-home-expand-shop" data-name="'+htmlChars(jtownUser.name)+'" data-size="'+productSize+'" data-nowPosition="'+productSize+'" data-spn="'+jtownUser.pn+'" data-url="'+jtownUser.shopUrl+'">';html+='	<div id="jt-home-expand-shop-notice" class="gotoPage" title="클릭시 해당 쇼핑몰로 이동됩니다.">';html+='		<span class="jt-home-expand-shop-firstQuotationMark"></span>';html+='		<pre id="jt-seller-expand-shop-text" class="jt-home-expand-shop-text">'+(nullValueCheck(jtownUser.longNotice)?"쇼핑몰의 홍보문구를 입력해주세요.":jtownUser.longNotice)+'</pre>';html+='		<span class="jt-home-expand-shop-lastQuotationMark"></span>';html+='	</div>';html+='	<div class="jt-home-expand-shop-expandProducts">';if(productSize>3){html+='		<button class="jt-home-expand-shop-leftArrow jt-home-expand-shop-arrow"><span>&lt;</span></button>'}else{html+='		<button class="jt-home-expand-shop-arrow"></button>'}html+='		<div class="jt-home-expand-shop-fake-dan">';html+='			<ul class="jt-home-expand-shop-expandProduct-slide">';html+='				'+bigProductHtml;html+='			</ul>';html+='		</div>';if(productSize>3){html+='		<button class="jt-home-expand-shop-rigthArrow jt-home-expand-shop-arrow"><span>&gt;</span></button>'}else{html+='		<button class="jt-home-expand-shop-arrow"></button>'}html+='		<div class="jt-home-expand-shop-products ">';html+='			'+smallProductHtml;html+='			'+tagHtml;html+='		</div>';html+='	</div>';html+='	<div class="jt-home-expand-shop-event gotoPage" id="jt-seller-expand-event-first" title="클릭시 해당 쇼핑몰로 이동됩니다.">';html+='		'+((jtownUser.bannerFirst!=null&&Number(jtownUser.bannerFirst)<3)?newEventHtml:'');html+='		<img alt="First Event" src="'+eventImage1+'"/>';html+='	</div>';html+='	<div class="jt-home-expand-shop-event gotoPage" id="jt-seller-expand-event-second" title="클릭시 해당 쇼핑몰로 이동됩니다.">';html+='		'+((jtownUser.bannerSecond!=null&&Number(jtownUser.bannerSecond)<3)?newEventHtml:'');html+='		<img alt="Second Event" src="'+eventImage2+'"/>';html+='	</div>';html+='	<ul class="jt-home-expand-shop-content-fn">';html+='		<li class="jt-home-expand-shop-content-view-wrap">';html+='			<span class="jt-home-expand-shop-content-view" title="최근 일주일간 방문수">Look</span>&nbsp;<span id="view-expand-'+spn+'">'+jtownUser.viewCount+'</span>';html+='		</li>';html+='		<li class="jt-home-expand-shop-content-comment-wrap">';html+='			<span class="jt-home-expand-shop-content-comment"></span>&nbsp;Comment&nbsp;<span id="comment-expand-'+spn+'" class="jt-home-expand-shop-content-comment-text">'+jtownUser.commentCount+'</span>';html+='			<div class="jt-home-expand-shop-border-hide"></div>';html+='		</li>';html+='		<li class="jt-home-expand-shop-content-love-wrap">';html+='			<div class="jt-heart-click-expand-wrap">';html+='				<div class="jt-heart-click-background" id="jt-heart-expand-click-'+spn+'">';html+='					<img alt="heart-background" src="'+contextPath+'resources/images/heart-background.png">';html+='				</div>';html+='				<div class="jt-heart-click">';html+='					<a href="#none" onclick="jtown.home.clickLove(\''+spn+'\');"><span class="jt-home-expand-shop-content-love '+loveClick+'" id="love-expand-image-'+spn+'">Love</span></a>';html+='				</div>';html+='			</div>';html+='			<div class="jt-home-expand-shop-content-love-text-wrap">';html+='				<span id="love-expand-'+spn+'" class="'+loveTextClick+'">'+jtownUser.loveCount+'</span>';html+='				'+loveHotCount;html+='			</div>';html+='		</li>';html+='	</ul>';html+='	<div class="jt-home-expand-shop-comment-wrap">';html+='		<ul class="jt-home-expand-shop-comment">';html+='			'+commentHtml;html+='		</ul>';html+='		<div class="jt-home-expand-shop-comment-insert">';html+='			'+commentInputHtml;html+='		</div>';html+='	</div>';html+='</div>';$.smartPop.open({width:640,height:650,html:html,effect:'transfer',target:'#jt-home-shop-'+spn});setTimeout('jtown.expand.setTimeout()',0);setTimeout('jtown.home.clickShop(\''+spn+'\');',0)})};jtown.expand.setTimeout=function(){jtown.expand.show=true;jtown.comment.syncComment();jtown.expand.changeContainerHeight();jtown.expand.gotoPage();jtown.seller.syncProduct();$(function(){$('#jt-comment-insert').placeholder();$('.jt-home-expand-shop-expandProducts').jCarouselLite({btnNext:".jt-home-expand-shop-leftArrow",btnPrev:".jt-home-expand-shop-rigthArrow",mouseWheel:true,speed:300,btnGo:['.0','.1','.2','.3','.4','.5','.6','.7','.8','.9','.10','.11','.12','.13','.14','.15','.16','.17','.18','.19',],afterEnd:function(e){setTimeout('jtown.seller.syncProduct()',0)}})})};jtown.expand.gotoPage=function(){$('.gotoPage').unbind('click').bind('click',function(){var parent=$(this).parents('.jt-home-expand-shop');var spn=parent.attr('data-spn');var url=parent.attr('data-url');var open=window.open('about:blank');open.location.href=url;jtown.home.goHome(spn)})};jtown.expand.changeContainerHeight=function(){var smartPopContainer=$('#smartPop_container');if(!nullValueCheck(smartPopContainer.html())){var smartPopContent=$('#smartPop_content');var height=$('#jt-home-expand-shop').css('height');height=Number(height.replace('px',''));var changeHeight=height+50;smartPopContainer.css('height',changeHeight+'px');smartPopContent.css('height',changeHeight+'px')}};if(typeof jtown.comment=='undefined'){jtown.comment={}}jtown.comment.syncComment=function(){var eventString=$.browser.chrome?'keydown':'keypress';$('#jt-comment-insert').unbind(eventString).bind(eventString,function(event){if(event.keyCode==13){jtown.comment.insertComment($(this))}});$('#jt-comment-insert').unbind('click').bind('click',function(){var $parent=$(this).parents('#jt-home-expand-shop'),spn=$parent.attr('data-spn'),name=$parent.attr('data-name');var url=contextPath+'ajax/home/existComment.jt',json={sellerPn:spn};$.postJSON(url,json,function(map){var result=map.result,authoriy=map.authority;if(authoriy!='CUSTOMER'){$('#jt-comment-insert').unbind('click');return}if(result){$('#jt-comment-insert').attr('readonly','readonly');jtown.dialog(name+' 쇼핑몰에 대한 댓글은<br/>하루에 한번만 가능합니다.')}else{$('#jt-comment-insert').removeAttr('readonly')}})});$('.jt-comment-delete').unbind('click').bind('click',function(){var me=$(this);jtown.confirm('댓글을 삭제하시겠습니까?',function(){jtown.comment.deleteComment(me)},function(){})});$('.jt-comment-update').unbind('click').bind('click',function(){var $parents=$(this).parents('li');$parents.find('.jt-home-expand-shop-tool-wrap').hide();$parents.find('.jt-home-expand-shop-text-wrap').hide();$parents.find('.jt-home-expand-shop-update-wrap').show();setTimeout('jtown.expand.changeContainerHeight()',0)});$('.jt-comment-update-input').unbind(eventString).bind(eventString,function(event){if(event.keyCode==13){jtown.comment.updateComment($(this))}else if(event.keyCode==27){jtown.comment.cancleComment($(this))}setTimeout('jtown.expand.changeContainerHeight()',0)});$('.jt-home-expand-shop-comment li').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){var display=$(this).find('.jt-home-expand-shop-update-wrap').css('display');if(display!='block'){if(event.type=='mouseover'){$(this).find('.jt-home-expand-shop-tool-wrap').show()}else if(event.type=='mouseout'){$(this).find('.jt-home-expand-shop-tool-wrap').hide()}}});$('#comment-add-btn-best').unbind('click').bind('click',function(event){var me=$(this);var url=contextPath+'ajax/home/selectCommentBest.jt';var json={sellerPn:me.attr('data-spn')};$.postJSON(url,json,function(comments){for(var i=0,len=comments.length;i<len;i++){var comment=comments[i];jtown.comment.commentHtml(comment,'last',true)}setTimeout('jtown.comment.syncComment()',0);$('#comment-add-btn-best').parents('li').remove();$('#comment-add-btn').parents('li').show()})});$('#comment-add-btn').unbind('click').bind('click',function(event){var me=$(this),page=(Number(me.attr('data-page'))+1),nextPage=(page+1),numItemsPerPage=me.attr('data-nipp'),numItems=me.attr('data-ni');var url=contextPath+'ajax/home/selectComment.jt';var json={page:page,sellerPn:me.attr('data-spn')};$.postJSON(url,json,function(comments){for(var i=0,len=comments.length;i<len;i++){var comment=comments[i];jtown.comment.commentHtml(comment,'last',false)}setTimeout('jtown.expand.changeContainerHeight()',0);setTimeout('jtown.comment.syncComment()',0);if(nextPage*numItemsPerPage<numItems||(page*numItemsPerPage<numItems&&nextPage*numItemsPerPage>=numItems)){me.attr('data-page',page);$('#comment-now-count').html(page*numItemsPerPage)}else{me.parents('li').remove()}})});$('.jt-home-expand-shop-comment-loveIt').unbind('click').bind('click',function(){var me=$(this),parents=me.parents('.jt-home-expand-shop-comment-li'),$shop=me.parents('#jt-home-expand-shop');if(nullValueCheck(parents.html())){parents=me.parents('.jt-home-expand-shop-comment-li-best')}var commentPn=parents.attr('data-copn');var url=contextPath+'ajax/home/toggleCommentLove.jt';var json={commentPn:commentPn,sellerPn:$shop.attr('data-spn')};$.postJSON(url,json,function(comment){if(!nullValueCheck(comment.message)){switch(Number(comment.message)){case 1:jtown.login.showLoginForm();break;case 2:jtown.dialog('판매자는 불가능 합니다.');break;default:break}}else{var crudType=comment.crudType;if(crudType=='insert'){$('.copnLoveIt-'+commentPn+' .jt-home-expand-shop-comment-loveIt-count').after('<a href="#none" class="jt-home-expand-shop-comment-loveIt-cancle">&nbsp;취소</a>');jtown.comment.loveCancle()}else if(crudType=='delete'){$('.copnLoveIt-'+commentPn).find('.jt-home-expand-shop-comment-loveIt-cancle').remove()}}})});jtown.comment.loveCancle();$('.jt-warn-active').unbind('click').bind('click',function(){var me=$(this),parents=me.parents('.jt-home-expand-shop-comment-li');if(nullValueCheck(parents.html())){parents=me.parents('.jt-home-expand-shop-comment-li-best')}var commentPn=parents.attr('data-copn');var url=contextPath+'ajax/home/warnCommentLove.jt';var json={commentPn:commentPn};$.postJSON(url,json,function(comment){if(!nullValueCheck(comment.message)){jtown.dialog(comment.message)}else{me.removeClass('jt-warn-active').addClass('jt-warn-disactive').unbind('click')}})})};jtown.comment.home=function(){$('.jt-home-shop-comments').unbind('mouseover').bind('mouseover',function(){var thiz=$(this),$parent=thiz.parents('.jt-home-shop-comments-wrap'),copn=thiz.attr('data-copn'),isSplit=thiz.attr('data-isSplit');thiz.unbind('mouseover');if(isSplit=='true'){$.postJSON(contextPath+'ajax/home/selectCommentOne.jt',{commentPn:copn},function(comment){var html='<div class="jt-more-comment-wrap">'+comment.comment+'</div>';thiz.after(html);$parent.find('.jt-more-comment-wrap').slideDown();thiz.unbind('mouseover').bind('mouseover',function(){var more=$(this).parents('.jt-home-shop-comments-wrap').find('.jt-more-comment-wrap');more.slideDown()});$('.jt-more-comment-wrap').unbind('mouseout').bind('mouseout',function(){$('.jt-more-comment-wrap').slideUp()})})}})};jtown.comment.syncHeight=function(copn,height){var $parent=$('#home-commentPn-'+copn).parents('.jt-home-shop');$parent.find('.jt-home-shop-comments-bar').height((Number(height)+20));$parent.find('.jt-home-shop-comments-bar').find('div').height(height)};jtown.comment.loveCancle=function(){$('.jt-home-expand-shop-comment-loveIt-cancle').unbind('click').bind('click',function(){var me=$(this),parents=me.parents('.jt-home-expand-shop-comment-li'),shop=me.parents('#jt-home-expand-shop');if(nullValueCheck(parents.html())){parents=me.parents('.jt-home-expand-shop-comment-li-best')}var commentPn=parents.attr('data-copn');var url=contextPath+'ajax/home/toggleCommentLove.jt';var json={commentPn:commentPn,sellerPn:shop.attr('data-spn')};$.postJSON(url,json,function(comment){if(!nullValueCheck(comment.message)){jtown.login.showLoginForm()}else{var crudType=comment.crudType;if(crudType=='delete'){$('.copnLoveIt-'+commentPn).find('.jt-home-expand-shop-comment-loveIt-cancle').remove()}}})})};jtown.comment.commentHtml=function(comment,position,best){var cpn=$('#jt-logout').attr('data-cpn');var cancleHtml='&nbsp;<a href="#none" class="jt-home-expand-shop-comment-loveIt-cancle">취소</a>';var cancleComment=nullValueCheck(comment.commentCustomerPn)?'':cancleHtml;var warnComment='';if(comment.customerPn!=cpn){if(nullValueCheck(comment.warnCustomerPn)){warnComment='&nbsp;<span href="#none" class="jt-warn-active" title="신고">WARN</span>'}else{warnComment='&nbsp;<span href="#none" class="jt-warn-disactive" title="신고">WARN</span>'}}var commentHtml='';commentHtml+='<li data-copn="'+comment.commentPn+'" class="'+(best?'jt-home-expand-shop-comment-li-best':'jt-home-expand-shop-comment-li')+'">';commentHtml+='	<ul class="jt-home-expand-shop-text-wrap">';if(best){commentHtml+='		<li class="jt-home-expand-shop-comment-header">';commentHtml+='			<span class="jt-home-expand-shop-comment-best">BEST</span>';commentHtml+='		</li>'}commentHtml+='		<li class="jt-home-expand-shop-comment-content">';commentHtml+='			<span class="jt-home-expand-shop-comment-name">'+htmlChars(comment.customerName)+'</span>';commentHtml+=' 			<span class="jt-home-expand-shop-comment-text">'+htmlChars(comment.comment)+'</span>';commentHtml+='		</li>';commentHtml+='		<li class="copnLoveIt-'+comment.commentPn+' jt-home-expand-shop-comment-footer">';commentHtml+='			<span class="jt-home-expand-shop-comment-progress-date">'+comment.inputDate+'</span>';commentHtml+=' 			<a href="#none" class="jt-home-expand-shop-comment-loveIt">LOVE</a>';commentHtml+='			<span class="jt-home-expand-shop-comment-loveIt-count">'+(nullValueCheck(comment.commentLoveCount)?'':comment.commentLoveCount)+'</span>'+cancleComment;commentHtml+='			'+warnComment;commentHtml+='		</li>';commentHtml+='	</ul>';if(comment.customerPn==cpn){commentHtml+='	<div class="jt-home-expand-shop-update-wrap">';commentHtml+='		<input type="text" class="jt-comment-update-input" value="'+htmlChars(comment.comment)+'" maxlength="100"/><br/>';commentHtml+='		<span>esc를 누르시면 수정이 취소 됩니다.</span>';commentHtml+='	</div>';commentHtml+='	<div class="jt-home-expand-shop-tool-wrap">';commentHtml+='		<a href="#none" class="jt-comment-update jt-btn-white-small">';commentHtml+='			<span class="btnImage"></span>';commentHtml+='		</a>';commentHtml+='		<a href="#none" class="jt-comment-delete jt-btn-white-small">';commentHtml+='			<span class="btnImage"></span>';commentHtml+='		</a>';commentHtml+='	</div>'}commentHtml+='</li>';var innerHtml=$('.jt-home-expand-shop-comment-li:'+position).html();if(!nullValueCheck(innerHtml)){if(position=='last')$('.jt-home-expand-shop-comment-li:'+position).after(commentHtml);else if(position=='first')$('.jt-home-expand-shop-comment-li:'+position).before(commentHtml)}else{var innerBestHtml=$('.jt-home-expand-shop-comment-li-best:last').html();if(!nullValueCheck(innerBestHtml)){$('.jt-home-expand-shop-comment-li-best:last').after(commentHtml)}else{$('.jt-home-expand-shop-comment').prepend(commentHtml)}}};jtown.comment.insertComment=function(me){var $parent=me.parents('#jt-home-expand-shop'),spn=$parent.attr('data-spn'),name=$parent.attr('data-name'),comment=me.val();if(nullValueCheck(comment)){return}var url,json={'sellerPn':spn};url=contextPath+'ajax/home/existLove.jt';$.postJSON(url,json,function(result){postComment=function(){url=contextPath+'ajax/home/insertComment.jt';json.comment=comment;$.postJSON(url,json,function(comment){me.val('');me.attr('readonly','readonly')})};if(!result){jtown.comment.loveconfirm(function(){jtown.home.clickLove(spn);setTimeout('postComment()',0)},function(){postComment()},name)}else{postComment()}})};jtown.comment.loveconfirm=function(success,cancle,name){var dialog='<div></div>';$(dialog).dialog({resizable:false,width:'270px',modal:true,buttons:{'Love':function(){success();$(this).dialog('close')},'Skip':function(){cancle();$(this).dialog('close')}}});$('.ui-dialog-titlebar').remove();$('.ui-widget-overlay').css('opacity','.9');$('.ui-dialog').removeClass('ui-widget-content').addClass('jt-love-dialog');$('.ui-dialog-content').removeClass('ui-widget-content').addClass('jt-love-dialog-content');$('.ui-dialog-content').after('<div class="jt-love-dialog-ment">댓글 입력이 완료되었습니다.<br/>쇼핑몰&nbsp;'+name+'을 추천하시겠어요?</div>');$('.ui-dialog-buttonpane').removeClass('ui-widget-content').addClass('jt-love-dialog-buttonpane');$('.ui-dialog-buttonset').addClass('jt-love-dialog-buttonset');$('.ui-button').removeClass().addClass('jt-love-dialog-button')};jtown.comment.deleteComment=function(me){var $shop=me.parents('#jt-home-expand-shop'),spn=$shop.attr('data-spn');var $parents=me.parents('li');var commentPn=$parents.attr('data-copn');var url=contextPath+'ajax/home/deleteComment.jt',json={'commentPn':commentPn,'sellerPn':spn};$.postJSON(url,json,function(){})};jtown.comment.updateComment=function(me){var $parents=me.parents('li');var commentPn=$parents.attr('data-copn'),comment=me.val();var url=contextPath+'ajax/home/updateComment.jt',json={'commentPn':commentPn,'comment':comment};$.postJSON(url,json,function(comment){$parents.find('.jt-home-expand-shop-text-wrap').show();$parents.find('.jt-home-expand-shop-update-wrap').hide()})};jtown.comment.cancleComment=function(me){var $parents=me.parents('li');$parents.find('.jt-home-expand-shop-text-wrap').show();$parents.find('.jt-home-expand-shop-update-wrap').hide();var text=$parents.find('.jt-home-expand-shop-comment-text').html();$parents.find('.jt-comment-update-input').val(text)};if(typeof jtown.board=='undefined'){jtown.board={}}jtown.board.noticeWrite=function(){$('#jt-admin-noticeWrite-btn').unbind('click').bind('click',function(){var form=document.forms['board'];form._method.value='post';oEditors[0].exec("UPDATE_CONTENTS_FIELD",[]);form.submit()});$('#jt-admin-noticeUpdate-btn').unbind('click').bind('click',function(){var form=document.forms['board'];form._method.value='put';oEditors[0].exec("UPDATE_CONTENTS_FIELD",[]);form.submit()})};if(typeof jtown.help=='undefined'){jtown.help={}}jtown.help.questionSync=function(){$('.jt-cQuestion-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['cQuestion'];BrowserDetect.init();form.browser.value=BrowserDetect.browser+'-'+BrowserDetect.version+' [ '+BrowserDetect.OS+' ] ';form.submit()});$('.jt-sQuestion-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['sQuestion'];BrowserDetect.init();form.browser.value=BrowserDetect.browser+'-'+BrowserDetect.version+' [ '+BrowserDetect.OS+' ] ';form.submit()});if(realPath==contextPath+'help/sQuestion.jt'){setTimeout("$('html, body').animate({scrollTop: '680px'}, 'slow')",0)}else if(realPath==contextPath+'help/cQuestion.jt'){setTimeout("$('html, body').animate({scrollTop: '100px'}, 'slow')",0)}else if(realPath==contextPath+'login/disactive.jt'){setTimeout("$('html, body').animate({scrollTop: $(document).height()}, 'slow')",0)}};