/*************************
 * MIT licensed
 *
 * Copyright (C) 2013 peoplegate - made by Francis ( Project : businessgate)
 * ***********************/
(function(root,factory){if(typeof exports==='object'){factory(exports)}else if(typeof define==='function'&&define.amd){define(['exports'],factory)}else{factory(root)}}(this,function(exports){var VERSION='0.4.0';function IntroJs(obj){this._targetElement=obj;this._options={nextLabel:'Next &rarr;',prevLabel:'&larr; Back',skipLabel:'Skip',doneLabel:'Done',tooltipPosition:'bottom',exitOnEsc:true,exitOnOverlayClick:true,showStepNumbers:true}}function _introForElement(targetElm){var introItems=[],self=this;if(this._options.steps){var allIntroSteps=[];for(var i=0,stepsLength=this._options.steps.length;i<stepsLength;i++){var currentItem=this._options.steps[i];currentItem.step=i+1;currentItem.element=document.querySelector(currentItem.element);introItems.push(currentItem)}}else{var allIntroSteps=targetElm.querySelectorAll('*[data-intro]');if(allIntroSteps.length<1){return false}for(var i=0,elmsLength=allIntroSteps.length;i<elmsLength;i++){var currentElement=allIntroSteps[i];introItems.push({element:currentElement,intro:currentElement.getAttribute('data-intro'),step:parseInt(currentElement.getAttribute('data-step'),10),position:currentElement.getAttribute('data-position')||this._options.tooltipPosition})}}introItems.sort(function(a,b){return a.step-b.step});self._introItems=introItems;if(_addOverlayLayer.call(self,targetElm)){_nextStep.call(self);var skipButton=targetElm.querySelector('.introjs-skipbutton'),nextStepButton=targetElm.querySelector('.introjs-nextbutton');self._onKeyDown=function(e){if(e.keyCode===27&&self._options.exitOnEsc==true){_exitIntro.call(self,targetElm);if(self._introExitCallback!=undefined){self._introExitCallback.call(self)}}else if(e.keyCode===37){_previousStep.call(self)}else if(e.keyCode===39||e.keyCode===13){_nextStep.call(self);if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}}};self._onResize=function(e){_setHelperLayerPosition.call(self,document.querySelector('.introjs-helperLayer'))};if(window.addEventListener){window.addEventListener('keydown',self._onKeyDown,true);window.addEventListener("resize",self._onResize,true)}else if(document.attachEvent){document.attachEvent('onkeydown',self._onKeyDown);document.attachEvent("onresize",self._onResize)}}return false}function _goToStep(step){this._currentStep=step-2;if(typeof(this._introItems)!=='undefined'){_nextStep.call(this)}}function _nextStep(){if(typeof(this._introBeforeChangeCallback)!=='undefined'){this._introBeforeChangeCallback.call(this,this._targetElement)}if(typeof(this._currentStep)==='undefined'){this._currentStep=0}else{++this._currentStep}if((this._introItems.length)<=this._currentStep){if(typeof(this._introCompleteCallback)==='function'){this._introCompleteCallback.call(this)}_exitIntro.call(this,this._targetElement);return}_showElement.call(this,this._introItems[this._currentStep])}function _previousStep(){if(this._currentStep===0){return false}if(typeof(this._introBeforeChangeCallback)!=='undefined'){this._introBeforeChangeCallback.call(this,this._targetElement)}_showElement.call(this,this._introItems[--this._currentStep])}function _exitIntro(targetElement){var overlayLayer=targetElement.querySelector('.introjs-overlay');overlayLayer.style.opacity=0;setTimeout(function(){if(overlayLayer.parentNode){overlayLayer.parentNode.removeChild(overlayLayer)}},500);var helperLayer=targetElement.querySelector('.introjs-helperLayer');if(helperLayer){helperLayer.parentNode.removeChild(helperLayer)}var showElement=document.querySelector('.introjs-showElement');if(showElement){showElement.className=showElement.className.replace(/introjs-[a-zA-Z]+/g,'').replace(/^\s+|\s+$/g,'')}var fixParents=document.querySelectorAll('.introjs-fixParent');if(fixParents&&fixParents.length>0){for(var i=fixParents.length-1;i>=0;i--){fixParents[i].className=fixParents[i].className.replace(/introjs-fixParent/g,'').replace(/^\s+|\s+$/g,'')}}if(window.removeEventListener){window.removeEventListener('keydown',this._onKeyDown,true)}else if(document.detachEvent){document.detachEvent('onkeydown',this._onKeyDown)}this._currentStep=undefined}function _placeTooltip(targetElement,tooltipLayer,arrowLayer){tooltipLayer.style.top=null;tooltipLayer.style.right=null;tooltipLayer.style.bottom=null;tooltipLayer.style.left=null;if(!this._introItems[this._currentStep])return;var currentTooltipPosition=this._introItems[this._currentStep].position;switch(currentTooltipPosition){case'top':tooltipLayer.style.left='15px';tooltipLayer.style.top='-'+(_getOffset(tooltipLayer).height+10)+'px';arrowLayer.className='introjs-arrow bottom';break;case'right':tooltipLayer.style.left=(_getOffset(targetElement).width+20)+'px';arrowLayer.className='introjs-arrow left';break;case'left':tooltipLayer.style.top='15px';tooltipLayer.style.right=(_getOffset(targetElement).width+20)+'px';arrowLayer.className='introjs-arrow right';break;case'bottom':default:tooltipLayer.style.bottom='-'+(_getOffset(tooltipLayer).height+10)+'px';arrowLayer.className='introjs-arrow top';break}}function _setHelperLayerPosition(helperLayer){if(helperLayer){if(!this._introItems[this._currentStep])return;var elementPosition=_getOffset(this._introItems[this._currentStep].element);helperLayer.setAttribute('style','width: '+(elementPosition.width+20)+'px; '+'height:'+(elementPosition.height+20)+'px; '+'top:'+(elementPosition.top-10)+'px;'+'left: '+(elementPosition.left-10)+'px;')}}function _showElement(targetElement){if(typeof(this._introChangeCallback)!=='undefined'){this._introChangeCallback.call(this,targetElement.element)}var self=this,oldHelperLayer=document.querySelector('.introjs-helperLayer'),elementPosition=_getOffset(targetElement.element);if(oldHelperLayer!=null){var oldHelperNumberLayer=oldHelperLayer.querySelector('.introjs-helperNumberLayer'),oldtooltipLayer=oldHelperLayer.querySelector('.introjs-tooltiptext'),oldArrowLayer=oldHelperLayer.querySelector('.introjs-arrow'),oldtooltipContainer=oldHelperLayer.querySelector('.introjs-tooltip'),skipTooltipButton=oldHelperLayer.querySelector('.introjs-skipbutton'),prevTooltipButton=oldHelperLayer.querySelector('.introjs-prevbutton'),nextTooltipButton=oldHelperLayer.querySelector('.introjs-nextbutton');oldtooltipContainer.style.opacity=0;_setHelperLayerPosition.call(self,oldHelperLayer);var fixParents=document.querySelectorAll('.introjs-fixParent');if(fixParents&&fixParents.length>0){for(var i=fixParents.length-1;i>=0;i--){fixParents[i].className=fixParents[i].className.replace(/introjs-fixParent/g,'').replace(/^\s+|\s+$/g,'')}}var oldShowElement=document.querySelector('.introjs-showElement');oldShowElement.className=oldShowElement.className.replace(/introjs-[a-zA-Z]+/g,'').replace(/^\s+|\s+$/g,'');if(self._lastShowElementTimer){clearTimeout(self._lastShowElementTimer)}self._lastShowElementTimer=setTimeout(function(){if(oldHelperNumberLayer!=null){oldHelperNumberLayer.innerHTML=targetElement.step}oldtooltipLayer.innerHTML=targetElement.intro;_placeTooltip.call(self,targetElement.element,oldtooltipContainer,oldArrowLayer);oldtooltipContainer.style.opacity=1},350)}else{var helperLayer=document.createElement('div'),arrowLayer=document.createElement('div'),tooltipLayer=document.createElement('div');helperLayer.className='introjs-helperLayer';_setHelperLayerPosition.call(self,helperLayer);this._targetElement.appendChild(helperLayer);arrowLayer.className='introjs-arrow';tooltipLayer.className='introjs-tooltip';tooltipLayer.innerHTML='<div class="introjs-tooltiptext">'+targetElement.intro+'</div><div class="introjs-tooltipbuttons"></div>';if(this._options.showStepNumbers){var helperNumberLayer=document.createElement('span');helperNumberLayer.className='introjs-helperNumberLayer';helperNumberLayer.innerHTML=targetElement.step;helperLayer.appendChild(helperNumberLayer)}tooltipLayer.appendChild(arrowLayer);helperLayer.appendChild(tooltipLayer);var nextTooltipButton=document.createElement('a');nextTooltipButton.onclick=function(){if(self._introItems.length-1!=self._currentStep){_nextStep.call(self)}};nextTooltipButton.href='javascript:void(0);';nextTooltipButton.innerHTML=this._options.nextLabel;var prevTooltipButton=document.createElement('a');prevTooltipButton.onclick=function(){if(self._currentStep!=0){_previousStep.call(self)}};prevTooltipButton.href='javascript:void(0);';prevTooltipButton.innerHTML=this._options.prevLabel;var skipTooltipButton=document.createElement('a');skipTooltipButton.className='introjs-button introjs-skipbutton';skipTooltipButton.href='javascript:void(0);';skipTooltipButton.innerHTML=this._options.skipLabel;skipTooltipButton.onclick=function(){if(self._introItems.length-1==self._currentStep&&typeof(self._introCompleteCallback)==='function'){self._introCompleteCallback.call(self)}if(self._introItems.length-1!=self._currentStep&&typeof(self._introExitCallback)==='function'){self._introExitCallback.call(self)}_exitIntro.call(self,self._targetElement)};var tooltipButtonsLayer=tooltipLayer.querySelector('.introjs-tooltipbuttons');tooltipButtonsLayer.appendChild(skipTooltipButton);tooltipButtonsLayer.appendChild(prevTooltipButton);tooltipButtonsLayer.appendChild(nextTooltipButton);_placeTooltip.call(self,targetElement.element,tooltipLayer,arrowLayer)}if(this._currentStep==0){prevTooltipButton.className='introjs-button introjs-prevbutton introjs-disabled';nextTooltipButton.className='introjs-button introjs-nextbutton';skipTooltipButton.innerHTML=this._options.skipLabel}else if(this._introItems.length-1==this._currentStep){skipTooltipButton.innerHTML=this._options.doneLabel;prevTooltipButton.className='introjs-button introjs-prevbutton';nextTooltipButton.className='introjs-button introjs-nextbutton introjs-disabled'}else{prevTooltipButton.className='introjs-button introjs-prevbutton';nextTooltipButton.className='introjs-button introjs-nextbutton';skipTooltipButton.innerHTML=this._options.skipLabel}nextTooltipButton.focus();targetElement.element.className+=' introjs-showElement';var currentElementPosition=_getPropValue(targetElement.element,'position');if(currentElementPosition!=='absolute'&&currentElementPosition!=='relative'){targetElement.element.className+=' introjs-relativePosition'}var parentElm=targetElement.element.parentNode;while(parentElm!=null){if(parentElm.tagName.toLowerCase()==='body')break;var zIndex=_getPropValue(parentElm,'z-index');if(/[0-9]+/.test(zIndex)){parentElm.className+=' introjs-fixParent'}parentElm=parentElm.parentNode}if(!_elementInViewport(targetElement.element)){var rect=targetElement.element.getBoundingClientRect(),top=rect.bottom-(rect.bottom-rect.top),bottom=rect.bottom-_getWinSize().height;if(top<0){window.scrollBy(0,top-30)}else{window.scrollBy(0,bottom+100)}}}function _getPropValue(element,propName){var propValue='';if(element.currentStyle){propValue=element.currentStyle[propName]}else if(document.defaultView&&document.defaultView.getComputedStyle){propValue=document.defaultView.getComputedStyle(element,null).getPropertyValue(propName)}if(propValue.toLowerCase){return propValue.toLowerCase()}else{return propValue}}function _getWinSize(){if(window.innerWidth!=undefined){return{width:window.innerWidth,height:window.innerHeight}}else{var D=document.documentElement;return{width:D.clientWidth,height:D.clientHeight}}}function _elementInViewport(el){var rect=el.getBoundingClientRect();return(rect.top>=0&&rect.left>=0&&(rect.bottom+80)<=window.innerHeight&&rect.right<=window.innerWidth)}function _addOverlayLayer(targetElm){var overlayLayer=document.createElement('div'),styleText='',self=this;overlayLayer.className='introjs-overlay';if(targetElm.tagName.toLowerCase()==='body'){styleText+='top: 0;bottom: 0; left: 0;right: 0;position: fixed;';overlayLayer.setAttribute('style',styleText)}else{var elementPosition=_getOffset(targetElm);if(elementPosition){styleText+='width: '+elementPosition.width+'px; height:'+elementPosition.height+'px; top:'+elementPosition.top+'px;left: '+elementPosition.left+'px;';overlayLayer.setAttribute('style',styleText)}}targetElm.appendChild(overlayLayer);overlayLayer.onclick=function(){if(self._options.exitOnOverlayClick==true){_exitIntro.call(self,targetElm)}if(self._introExitCallback!=undefined){self._introExitCallback.call(self)}};setTimeout(function(){styleText+='opacity: .8;';overlayLayer.setAttribute('style',styleText)},10);return true}function _getOffset(element){var elementPosition={};elementPosition.width=element.offsetWidth;elementPosition.height=element.offsetHeight;var _x=0;var _y=0;while(element&&!isNaN(element.offsetLeft)&&!isNaN(element.offsetTop)){_x+=element.offsetLeft;_y+=element.offsetTop;element=element.offsetParent}elementPosition.top=_y;elementPosition.left=_x;return elementPosition}function _mergeOptions(obj1,obj2){var obj3={};for(var attrname in obj1){obj3[attrname]=obj1[attrname]}for(var attrname in obj2){obj3[attrname]=obj2[attrname]}return obj3}var introJs=function(targetElm){if(typeof(targetElm)==='object'){return new IntroJs(targetElm)}else if(typeof(targetElm)==='string'){var targetElement=document.querySelector(targetElm);if(targetElement){return new IntroJs(targetElement)}else{throw new Error('There is no element with given selector.');}}else{return new IntroJs(document.body)}};introJs.version=VERSION;introJs.fn=IntroJs.prototype={clone:function(){return new IntroJs(this)},setOption:function(option,value){this._options[option]=value;return this},setOptions:function(options){this._options=_mergeOptions(this._options,options);return this},start:function(){_introForElement.call(this,this._targetElement);return this},goToStep:function(step){_goToStep.call(this,step);return this},exit:function(){_exitIntro.call(this,this._targetElement)},onbeforechange:function(providedCallback){if(typeof(providedCallback)==='function'){this._introBeforeChangeCallback=providedCallback}else{throw new Error('Provided callback for onbeforechange was not a function');}return this},onchange:function(providedCallback){if(typeof(providedCallback)==='function'){this._introChangeCallback=providedCallback}else{throw new Error('Provided callback for onchange was not a function.');}return this},oncomplete:function(providedCallback){if(typeof(providedCallback)==='function'){this._introCompleteCallback=providedCallback}else{throw new Error('Provided callback for oncomplete was not a function.');}return this},onexit:function(providedCallback){if(typeof(providedCallback)==='function'){this._introExitCallback=providedCallback}else{throw new Error('Provided callback for onexit was not a function.');}return this}};exports.introJs=introJs;return introJs}));$(function(){$('.jt-header-nav-interestCategory-li').bind('mouseover mouseout',function(event){jtown.header.showSubNavigation($(this).find('.jt-header-nav-interest'),event.type)});$('#jt-login-smartPopup').bind('click',function(){jtown.header.showLoginForm()});$('#jt-mypage').bind('mouseover mouseout',function(event){jtown.header.showSubNavigation($('#jt-mypage-wrap'),event.type)});$('#jt-help').bind('mouseover mouseout',function(event){jtown.header.showSubNavigation($('#jt-help-wrap'),event.type)});$('#resendConfirmMail').bind('click',function(){jtown.header.resendEmailAddress()});$('#jt-naturalLanguage-search').placeholder();jtown.naturalLanguage.autocomplete();if(!nullValueCheck($container.html())){jtown.home.masonry.start()}if(realPath==contextPath+'help/sQuestion.jt'){setTimeout("$('html, body').animate({scrollTop: '680px'}, 'slow')",0)}else if(realPath==contextPath+'help/cQuestion.jt'){setTimeout("$('html, body').animate({scrollTop: '100px'}, 'slow')",0)}else if(realPath==contextPath+'login/disactive.jt'){setTimeout("$('html, body').animate({scrollTop: $(document).height()}, 'slow')",0)}$('#page-wrap').css('width',$('#page-wrap>div').width());$('#jt-comment-insert').placeholder();$('#username_findPassword').placeholder();$('#username_findSellerPassword').placeholder();$('#j_username_page, #j_password_page').placeholder();$('#partnership_content').placeholder();$('#cQuestion #name').placeholder();$('#cQuestion #email').placeholder();$('#sQuestion #shopPn').placeholder();$('#sQuestion #name').placeholder();$('#sQuestion #email').placeholder();$('#sQuestion #content').placeholder();$('#partnership #shopUrl').placeholder();$('#partnership #email').placeholder()});jtown.postJSON=function(url,json,option,callback){jtown.loading={start:function(){$('#loading-popup').fadeIn()},finish:function(){$('#loading-popup').fadeOut()}};jtown.loading.start();$.postJSON(url,json,function(){callback();jtown.loading.finish()})};jtown.dialog=function(message){var dialog='<div style="text-align:center; margin-top: 15px; font-weight: bold; line-height : 16px;">'+message+'</div>';$(dialog).dialog({resizable:false,width:'300px',hegiht:'200px',modal:true,buttons:{'Close':function(){$(this).dialog('close')}}});$('.ui-dialog-titlebar').removeClass('ui-widget-header');$('.ui-dialog-buttonset').css({'float':'none','text-align':'center'})};jtown.confirm=function(message,success,cancle){var dialog='<div style="text-align:center; margin-top: 25px; font-weight: bold;">'+message+'</div>';$(dialog).dialog({resizable:false,width:'300px',hegiht:'200px',modal:true,buttons:{'확인':function(){success();$(this).dialog('close')},'취소':function(){cancle();$(this).dialog('close')}}});$('.ui-dialog-titlebar').removeClass('ui-widget-header');$('.ui-dialog-buttonset').css({'float':'none','text-align':'center'})};if(typeof jtown.header=='undefined'){jtown.header={}}jtown.header.showSubNavigation=function(object,eventType){if(eventType=='mouseover')object.show();else if(eventType=='mouseout')object.hide()};jtown.header.resendEmailAddress=function(){var url=contextPath+'ajax/resendConfirmEmail.jt',json={},option={position:'.jt-header-warning-confirmEmail',img:contextPath+'resources/images/jt-loading-02.gif'};$('#resendConfirmMail').unbind('click');jtown.postJSON(url,json,option,function(){jtown.dialog('E-mail을 재전송 하였습니다.');$('#resendConfirmMail').bind('click',function(){jtown.header.resendEmailAddress()})})};jtown.header.showLoginForm=function(){var inner=$('#jt-login-form-wrap'),form=inner.find('form[name=jt-popup-login-form]'),j_username=inner.find('input[name=j_username]'),j_password=inner.find('input[name=j_password]');form.attr('id','jt-popup-login-form');j_username.attr('id','j_username');j_password.attr('id','j_password');$.smartPop.open({width:430,height:350,html:inner.html(),effect:null});form.attr('id','');j_username.attr('id','');j_password.attr('id','');setTimeout('$(function() { $(\'#j_username, #j_password\').placeholder(); });',0)};if(typeof jtown.home=='undefined'){jtown.home={}}var $container=$('#jt-home-container');jtown.home.masonry={start:function(){$container.imagesLoaded(function(){$container.masonry({itemSelector:'.jt-home-shop',columnWidth:330,transitionDuration:0.})});this.pagination();this.resize();this.scrollTop();$(window).scroll(this.move);$(window).resize(this.resize)},pagination:function(){$container.scrollPagination({'contentPage':contextPath+'ajax/homePagination.jt','contentData':{'categoryPn':Number($('#jt-home-container').attr('data-cpn')),'sectionPn':Number($('#jt-home-container').attr('data-spn'))},'scrollTarget':$(window),'successCallback':function(data){if($.browser.msie&&$.browser.version=='7.0'){var html=jtown.home.html(data),$boxes=$(html);$container.append($boxes).masonry('appended',$boxes);$container.imagesLoaded(function(){$container.masonry('reload')})}else{var htmlArray=jtown.home.html(data);$container.append(htmlArray).masonry('appended',htmlArray);$container.imagesLoaded(function(){$container.masonry()})}setTimeout('jtown.expand.loadExpandShop()',0)},'maxPage':$('#jt-home-container').attr('data-maxPage')})},resize:function(){var clientWidth=Number(window.document.body.clientWidth),widthItem=Math.floor(clientWidth/330);if(widthItem<3)widthItem=3;$('#jt-home-container').css({width:(widthItem*330),margin:'auto'})},scrollTop:function(){$('#jt-scroll-top').bind('click',function(){$('html, body').animate({scrollTop:0},'slow')})},move:function(){var scrollheight={topHeight:'46px',downHeight:'1px'};var isEmail=$('.jt-footer').attr('data-isEmail');BrowserDetect.init();if(isEmail){scrollheight={topHeight:'76px',downHeight:'31px'}}if(!nullValueCheck(BrowserDetect.browser)&&BrowserDetect.browser=='Explorer'){if(!nullValueCheck(BrowserDetect.version)&&BrowserDetect.version<9){scrollheight={topHeight:'50px',downHeight:'5px'};if(isEmail){scrollheight={topHeight:'80px',downHeight:'35px'}}}}var element=document.documentElement;var body=document.body;var scrollY=document.all?(!element.scrollTop?body.scrollTop:element.scrollTop):(window.pageYOffset?window.pageYOffset:window.scrollY);if(scrollY==0){$('.jt-header-title').slideDown('fast');setTimeout('$(".jt-header-nav-interestCategory").css("top", "'+scrollheight.topHeight+'")');setTimeout('$(".jt-footer").slideUp()',0)}else{$('.jt-header-title').slideUp('fast',function(){$('.jt-header-nav-interestCategory').css('top',scrollheight.downHeight);setTimeout('$(".jt-footer").slideDown()',0)})}}};jtown.home.clickShop=function(spn){var url=contextPath+'ajax/clickView.jt',json={sellerPn:spn};$.postJSON(url,json,function(){})};jtown.home.goHome=function(spn){var url=contextPath+'ajax/goHome.jt',json={sellerPn:spn};$.postJSON(url,json,function(){})};jtown.home.clickLove=function(spn){var url=contextPath+'ajax/clickLove.jt',json={sellerPn:spn};$.postJSON(url,json,function(count){if(!nullValueCheck(count.message)){if(count.message=='1'){jtown.header.showLoginForm()}else{jtown.dialog('판매자는 불가능합니다')}}else{var spn=count.sellerPn;var crudType=count.crudType;if(crudType=='insert'){$('#jt-heart-click-'+spn).addClass('jt-heart-animation')}else if(crudType=='delete'){$('#jt-heart-click-'+spn).removeClass('jt-heart-animation')}var expandShop=$('#jt-home-expand-shop');if(!nullValueCheck(expandShop.html())){var expandSpn=expandShop.attr('data-spn');if(spn==expandSpn){if(crudType=='insert'){$('#jt-heart-expand-click-'+spn).addClass('jt-heart-animation')}else if(crudType=='delete'){$('#jt-heart-expand-click-'+spn).removeClass('jt-heart-animation')}}}}})};jtown.home.html=function(data){var jtownUsers=data.jtownUsers;var images=data.images;var browser=$.browser;var htmlArray=[];var html='';for(var i=0,len=jtownUsers.length;i<len;i++){var seller=jtownUsers[i],spn=seller.pn,mainImages=images[spn];var imageHtml='';if(mainImages.length==0){imageHtml+='<img alt="Blank" src="'+contextPath+'resources/images/jt-introduce-home-blank.png" title="'+htmlChars(seller.name)+'"/>	'}for(var j=0,jLen=mainImages.length;j<jLen;j++){var mainImage=mainImages[j];var imageSrc=contextPath+'resources/uploadImage/'+mainImage;if(nullValueCheck(imageSrc)){imageSrc=contextPath+'resources/images/jt-introduce-home-blank.png'}imageHtml+='<img alt="" src="'+imageSrc+'" title="'+htmlChars(seller.name)+'"/>	'}var loveClick=!nullValueCheck(seller.customerPn)?'jt-home-shop-love-click':'';var loveTextClick=!nullValueCheck(seller.customerPn)?'jt-home-shop-love-text-click':'';var loveHotCount='<span class="jt-home-shop-love-hot" title="최근 뜨는 미니샵">HOT</span>';if(nullValueCheck(seller.loveHotCount)||seller.loveHotCount==0){loveHotCount=''}var msieHtml='';if(browser.msie){if(browser.version=='7.0'||browser.version=='8.0'){msieHtml='<div class="jt-home-shop-image-footer"></div>'}}html+='	<div class="jt-home-shop" id="jt-home-shop-'+spn+'"  data-spn="'+spn+'">';html+='		<header>';html+='			<a href="'+seller.shopUrl+'" target="_blank" onclick="jtown.home.goHome(\''+spn+'\')">'+htmlChars(seller.name)+'</a>';html+='		</header>';html+='		<div class="jt-home-shop-content">';html+='			<ul class="jt-home-shop-content-image">';html+='				<li>';html+='					'+imageHtml;html+='					<div class="jt-home-shop-new-event">';html+='						<div id="new-product-'+spn+'" class="jt-home-shop-new-event-div" style="'+((seller.newProduct>0)?"display: block;":"display:none;")+'">';html+=' 							<span class="jt-home-shop-product-new-image">New arrive</span>';html+='						</div>';html+='						<div id="new-'+spn+'" class="jt-home-shop-new-event-div" style="'+(seller.newBanner?"display: block;":"display:none;")+'">';html+=' 							<span class="jt-home-shop-event-new-image">New event</span>';html+='						</div>';html+='					</div>';html+='				</li>';html+='			</ul>';html+='		</div>';html+='		<div class="jt-home-notice">';html+='			<span class="jt-home-shop-footer-firstQuotationMark">"</span>';html+='			<pre class="jt-home-shop-footer-text">'+htmlChars(seller.notice)+'</pre>';html+='			<span class="jt-home-shop-footer-lastQuotationMark">"</span>';html+='		</div>';html+='		<ul class="jt-home-shop-content-fn">';html+='			<li>';html+='				<span class="jt-home-shop-view" title="최근 일주일간 방문수">VIEW</span>&nbsp;<span id="view-'+spn+'">'+(nullValueCheck(seller.viewCount)?0:seller.viewCount)+'</span>';html+='			</li>';html+='			<li>';html+='				<span class="jt-home-shop-comment">COMMENT</span>&nbsp;<span id="comment-'+spn+'">'+(nullValueCheck(seller.commentCount)?0:seller.commentCount)+'</span>';html+='			</li>';html+='			<li>';html+='			<div class="jt-heart-click-wrap">';html+='				<div class="jt-heart-click-background" id="jt-heart-click-'+spn+'">';html+='					<img alt="heart-background" src="'+contextPath+'resources/images/heart-background.png">';html+='				</div>';html+='				<div class="jt-heart-click">';html+='				<a href="#none" onclick="jtown.home.clickLove(\''+spn+'\');"id="love-image-'+spn+'" class="jt-home-shop-love '+loveClick+'">♥</a>';html+='				</div>';html+='			</div>';html+='			<div class="jt-home-shop-content-love-text-wrap">';html+='				<span id="love-'+spn+'" class="'+loveTextClick+'">'+(nullValueCheck(seller.loveCount)?0:seller.loveCount)+'</span>';html+='				'+loveHotCount;html+='			</div>';html+='			</li>';html+='		</ul>';html+='		'+msieHtml;html+='	</div>';if(!(browser.msie&&browser.version=='7.0')){htmlArray[i]=$(html).get(0);html=''}}if(!(browser.msie&&browser.version=='7.0')){return htmlArray}else{return html}};if(typeof jtown.naturalLanguage=='undefined'){jtown.naturalLanguage={}}jtown.naturalLanguage.autocomplete=function(){$.widget("custom.catcomplete",$.ui.autocomplete,{_renderMenu:function(ul,items){var that=this,currentCategory="";$.each(items,function(index,item){if(item.category!=currentCategory){ul.append('<li class="ui-autocomplete-category"><span class="ui-autocomplete-category-span">'+item.category+'</span></li>');currentCategory=item.category}that._renderItem=function(ul,item){return $('<li>').append('<a class="ui-catcomplete-menu-item">'+item.label+'</a>').appendTo(ul)};that._renderItemData(ul,item)})}});$('#jt-naturalLanguage-search').catcomplete({source:function(request,response){var url=contextPath+'ajax/natural/autocomplete.jt',json={searchName:request.term};$.postJSON(url,json,function(map){var jtownUsers=map.jtownUsers,interests=map.interests,data=[];for(var i=0,len=jtownUsers.length;i<len;i++){var jtownUser=jtownUsers[i];data[i]={label:jtownUser.name,value:jtownUser.name,pn:jtownUser.pn,category:'SHOP'}}for(var i=0,len=interests.length,size=jtownUsers.length;i<len;i++){var interest=interests[i];data[i+size]={label:interest.naturalName,value:interest.naturalName,categoryPn:interest.categoryPn,spn:interest.sectionPn,category:'CATEGORY'}}response(data)})},minLength:1,select:function(event,ui){var item=ui.item;if(item.category=='SHOP'){location.href=contextPath+'mir/'+item.pn}else if(item.category=='CATEGORY'){location.href=contextPath+'cpn/'+item.categoryPn+'/spn/'+item.spn}},focus:function(event,ui){$('.ui-state-focus').removeClass('ui-corner-all').removeClass('ui-state-focus')},open:function(){$('.ui-autocomplete').removeClass('ui-widget-content').addClass('ui-catcomplete-content');$(this).addClass('ui-catcomplete-input');$('.ui-menu').css({padding:0})},close:function(){$(this).removeClass('ui-catcomplete-input');$('#jt-naturalLanguage-search').val('')}})};function trim(character){character=character.replace(/^\s*/,'');character=character.replace(/\s*$/,'');return character}function htmlChars(character){if(nullValueCheck(character)){return""}var str=((character.replace('"','&amp;')).replace('"','&quot;')).replace('\'','&#39;');return(str.replace('<','&lt;')).replace('>','&gt;')}function fmtNumber(number){var reg=/(^[+-]?\d+)(\d{3})/;number+='';while(reg.test(number))number=number.replace(reg,'$1'+','+'$2');return number}function changeFileString(character){var changeChar=character.toString();changeChar=changeChar.replace(/<PRE>/ig,'');changeChar=changeChar.replace(/<\/PRE>/ig,'');return changeChar}function nullValueCheck(object){if(object==null||object==undefined||object==''||object=='undefined'){return true}return false}function split(val){return val.split(/,\s*/)}var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string;var dataProp=data[i].prop;this.versionSearchString=data[i].versionSearch||data[i].identity;if(dataString){if(dataString.indexOf(data[i].subString)!=-1)return data[i].identity}else if(dataProp)return data[i].identity}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(index==-1)return;return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};function checkKeycode(e){var keycode=0;if(window.event)keycode=window.event.keyCode;else if(e)keycode=e.which;if(keycode==116){keycode=2;location.href=realPath;return false}else if(e.ctrlKey&&(keycode==78||keycode==82)){location.href=realPath;return false}}$(function(){jtown.login.confirmEmail();jtown.login.passwordLength();jtown.login.confirmPassword();jtown.login.joinFormSubmit();jtown.login.nickNameLength();jtown.login.changeUserSubmit();jtown.login.modifyPasswordLength();jtown.login.disactiveUser();jtown.login.confirmId();$('#jt-findUserPassword-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['jtownUser'];form.submit()});$('#jt-findSellerPassword-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['sellerUser'];form.submit()});$('#jt-emailAddress-user-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['jtownUser'];form.submit()})});function onPopupLoginSubmit(){onLoginSubmit('jt-popup-login-form')}function onLoginSubmit(name){var $form=$('#'+name);jQuery.ajax({'type':'POST','url':contextPath+'j_spring_security_check','data':$form.serialize(),'dataType':'text','success':function(data){jtown.login.control(data,name)}})}if(typeof jtown.login=='undefined'){jtown.login={}}jtown.login.control=function(data,name){var map=eval('('+data+')'),result=map.result,url=map.url;if(result=='success'){location.href=contextPath+url;return}else if(result=='error'){location.href=contextPath+'login/?isFinish=0';return}};jtown.login.confirmEmail=function(){$('input[data-type=create]').keyup(function(){var regExp=/^[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[@]{1}[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[.]{1}[A-Za-z]{2,5}$/;var username=$(this).val();if(regExp.test(username)){$('#confirmEmail>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmEmail>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){var regExp=/^[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[@]{1}[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[.]{1}[A-Za-z]{2,5}$/;var username=$(this).val();if(regExp.test(username)){$('#confirmEmail>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmEmail>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}$('#confirmEmail').show()}).blur(function(){$('#confirmEmail').hide()})};jtown.login.confirmId=function(){$('input[data-type=createId]').keyup(function(){var regExp=/^[0-9A-Za-z가-힣]*$/;var username=$(this).val();if(regExp.test(username)){$('#confirmEmail>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmEmail>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){var regExp=/^[0-9A-Za-z가-힣]*$/;var username=$(this).val();if(regExp.test(username)){$('#confirmEmail>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmEmail>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}$('#confirmEmail').show()}).blur(function(){$('#confirmEmail').hide()})};jtown.login.passwordLength=function(){$('input[data-form=joinPw]').keyup(function(){var length=$(this).val().length;if(length>=8&&length<=16){$('#passwordLength>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#passwordLength>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#passwordLength').show()}).blur(function(){$('#passwordLength').hide()})};jtown.login.confirmPassword=function(){$('input[name=confirmPassword]').keyup(function(){var cpw=$(this).val();var pw=nullValueCheck($('input[data-form=joinPw]').val())?$('input[data-form=modify]').val():$('input[data-form=joinPw]').val();if(cpw==pw){$('#confirmPW>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmPW>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){var cpw=$(this).val();var pw=nullValueCheck($('input[data-form=joinPw]').val())?$('input[data-form=modify]').val():$('input[data-form=joinPw]').val();if(cpw==pw){$('#confirmPW>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmPW>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}$('#confirmPW').show()}).blur(function(){$('#confirmPW').hide()})};jtown.login.nickNameLength=function(){$('input[data-form=join]').keyup(function(){var regExp=/^[0-9A-Za-z가-힣]*$/;var name=$(this).val();var length=name.length;if(regExp.test(name)&&length>0){$('#nameLength>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#nameLength>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){var regExp=/^[0-9A-Za-z가-힣]*$/;var name=$(this).val();var length=name.length;if(regExp.test(name)&&length>0){$('#nameLength>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#nameLength>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}$('#nameLength').show()}).blur(function(){$('#nameLength').hide()})};jtown.login.joinFormSubmit=function(){$('.jt-join-submit').unbind('click');$('.jt-join-submit').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['jtownUser'];form.submit()})};jtown.login.changeUserSubmit=function(){$('.jt-change-user-btn').unbind('click').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['jtownUser'];form.action=contextPath+'login/modify.jt';form.submit()})};jtown.login.disactiveUser=function(){$('.jt-disactive-user-btn').toggle(function(){$('.jt-disactive-content').show();setTimeout("$('html, body').animate({scrollTop: $(document).height()}, 'slow')",0)},function(){$('.jt-disactive-content').slideUp()});$('.jt-disactive-btn').unbind('click').bind('click',function(){jtown.confirm('계정을 정말로 삭제하시겠습니까?',function(){var form=document.forms['disactiveUser'];form.submit()},function(){})});$('.jt-disactive-cancle-btn').unbind('click').bind('click',function(){jtown.confirm('계정 삭제를 취소하시겠습니까?',function(){var form=document.forms['disactiveUser'];form.submit()},function(){})})};jtown.login.modifyPasswordLength=function(){$('input[data-form=modify]').keyup(function(){var length=$(this).val().length;if(length>=8&&length<=16){$('#passwordLength>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#passwordLength>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#passwordLength').show()}).blur(function(){$('#passwordLength').hide()})};if(typeof jtown.admin=='undefined'){jtown.admin={}}$(function(){jtown.admin.sellerCreate();jtown.admin.sellerSync();$('.jt-reset-password').unbind('click').bind('click',function(){var json={username:$(this).attr('data-username')},url=contextPath+'admin/ajax/resetPassword.jt';$.postJSON(url,json,function(){jtown.dialog('재설정 되었습니다.')})});$('.jt-partnership-table-information').unbind('click').bind('click',function(){var partnershipPn=$(this).parents('.jt-partnership-info').attr('data-pspn');$('#partnership-content-'+partnershipPn).toggle()});$('.jt-admin-customer-enable').unbind('change').bind('change',function(){var parents=$(this).parents('.jt-admin-customer-table-tr'),json={'pn':parents.attr('data-cpn'),'enabled':($(this).val()==1?true:false)},url=contextPath+'admin/ajax/changeEnabled.jt';$.postJSON(url,json,function(){})});jtown.admin.changeText('jt-partnership-name',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/updatePartnershipName.jt',json={pn:grandParent.attr('data-pspn'),name:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeText('jt-partnership-email',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/updatePartnershipEmail.jt',json={pn:grandParent.attr('data-pspn'),email:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeText('jt-partnership-phoneNumber',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/updatePartnershipPhoneNumber.jt',json={pn:grandParent.attr('data-pspn'),phoneNumber:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeSelect('jt-partnership-category',function(thiz,nameVo){success=function(){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/updatePartnershipCategory.jt',json={pn:grandParent.attr('data-pspn'),categoryPn:thiz.val()};$.postJSON(url,json,function(partnership){var pn=partnership.jtownUser.pn;if(pn!=null&&pn!=0){grandParent.find('.jt-partnership-interest').html('')}})};cancle=function(){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/selectPartnershipCategory.jt',json={pn:grandParent.attr('data-pspn')};$.postJSON(url,json,function(categoryPn){thiz.val(categoryPn)})};jtown.confirm('사업아이템을 바꾸시겠습니까?',success,cancle)});jtown.admin.changeSelect('jt-partnership-adminPn',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/changePartnershipJson.jt',json={key:grandParent.attr('data-pspn'),value:thiz.val()};$.postJSON(url,json,function(partnership){})});jtown.admin.changeSelect('jt-partnership-process',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/updatePartnership.jt',json={pn:grandParent.attr('data-pspn'),process:thiz.val()};$.postJSON(url,json,function(partnership){})});jtown.admin.changeSelect('jt-partnership-deposit',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/updatePartnership.jt',json={pn:grandParent.attr('data-pspn'),deposit:thiz.val()};$.postJSON(url,json,function(partnership){})});jtown.admin.changeTextarea('jt-partnership-note',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/updatePartnershipNote.jt',json={pn:grandParent.attr('data-pspn'),note:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html('<pre>'+htmlChars(object.value)+'</pre>')}})})});jtown.admin.sellerCreate=function(){$('.jt-seller-create-btn').unbind('click').bind('click',function(){var thiz=$(this),parent=thiz.parents('.jt-partnership-info'),pspn=parent.attr('data-pspn');var url=contextPath+'admin/ajax/createSeller.jt';var json={pn:pspn,shopUrl:thiz.attr('data-shopUrl'),name:thiz.attr('data-name')};$.postJSON(url,json,function(jtownUser){parent.attr('data-spn',jtownUser.pn);parent.find('.jt-seller-create').html('<a href="'+contextPath+'seller/'+jtownUser.pn+'">'+jtownUser.username+'</a>').removeClass('jt-seller-create').addClass('jt-partnership-username');parent.find('.jt-seller-shopPn').text(jtownUser.sixShopPn).removeClass('jt-seller-shopPn').addClass('jt-partnership-shopPn');parent.find('.jt-seller-shopUrl').addClass('jt-partnership-shopUrl').removeClass('jt-seller-shopUrl');parent.find('.jt-seller-name').addClass('jt-partnership-sellerName').removeClass('jt-seller-name');parent.find('.jt-seller-enabled').addClass('jt-partnership-enabled').removeClass('jt-seller-enabled');parent.find('.jt-partnership-enabled-select').css('display','block');parent.find('.jt-seller-interest').text('').addClass('jt-partnership-interest').removeClass('jt-seller-interest');parent.find('.jt-seller-date').text('').addClass('jt-partnership-contract-date').removeClass('jt-seller-date');var btn='<button type="button" class="jt-admin-contract jt-btn-white-small"><span class="btnText">조회</span></button>';parent.find('.jt-seller-register').html(btn).addClass('jt-partnership-contract-register').removeClass('jt-seller-register');setTimeout('jtown.admin.sellerSync()',0)})})};jtown.admin.sellerSync=function(){jtown.admin.changeText('jt-partnership-shopUrl',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/changeSellerShopUrl.jt',json={pn:grandParent.attr('data-spn'),shopUrl:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeText('jt-partnership-sellerName',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/changeSellerName.jt',json={pn:grandParent.attr('data-spn'),name:thiz.val()};$.postJSON(url,json,function(object){if(object.key==1){alert(object.value);thiz.focus()}else{parent.html(htmlChars(object.value))}})},function(){});jtown.admin.changeText('jt-partnership-interest',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),parent=thiz.parents(nameVo.selector),url=contextPath+'admin/ajax/changeInterest.jt',category=grandParent.find('.jt-partnership-category-select'),json={sellerPn:grandParent.attr('data-spn'),categoryPn:category.val(),interestSectionList:thiz.val()};$.postJSON(url,json,function(){parent.html(htmlChars(thiz.val()))})},jtown.admin.autoInterestOne);jtown.admin.changeSelect('jt-partnership-enabled',function(thiz,nameVo){var grandParent=thiz.parents(nameVo.parentSelector),url=contextPath+'admin/ajax/changeEnabled.jt',json={pn:grandParent.attr('data-spn'),enabled:(thiz.val()==1?true:false)};$.postJSON(url,json,function(jtownUser){})});$('.jt-admin-contract').unbind('click').bind('click',function(){var parent=$(this).parents('.jt-partnership-info'),spn=parent.attr('data-spn');var url=contextPath+'admin/contract/?sellerPn='+spn;var option='width=800, height=300, resizable=no, scrollbars=no, status=no';window.open(url,'',option)})};jtown.admin.changeText=function(name,callback,event){var eventString=$.browser.chrome?'keydown':'keypress';var nameVo={selector:'.'+name,input:name+'-input',inputSelector:'#'+name+'-input',parentSelector:'.jt-partnership-info'};$(nameVo.selector).unbind('mouseup').bind('mouseup',function(){var me=$(this),value=me.text(),html='<input class="" id="'+nameVo.input+'" type="text" value="'+value+'" style="width: '+(Number(me.width())-14)+'px;"/>';me.html(html);setTimeout(event,0);$(nameVo.inputSelector).focus();$(nameVo.inputSelector).bind('focusout',function(){callback($(this),nameVo)});$(nameVo.inputSelector).bind(eventString,function(event){if(event.keyCode==13){callback($(this),nameVo)}else if(event.keyCode==27){me.html(htmlChars(value))}})})};jtown.admin.changeSelect=function(name,callback){var nameVo={selector:'.'+name,input:name+'-select',inputSelector:'.'+name+'-select',parentSelector:'.jt-partnership-info'};$(nameVo.inputSelector).unbind('change').bind('change',function(){callback($(this),nameVo)})};jtown.admin.changeTextarea=function(name,callback,event){var eventString=$.browser.chrome?'keydown':'keypress';var nameVo={selector:'.'+name,input:name+'-input',inputSelector:'#'+name+'-input',parentSelector:'.jt-partnership-info'};$(nameVo.selector).unbind('mouseup').bind('mouseup',function(){var me=$(this),value=me.text(),html='<textarea class="" id="'+nameVo.input+'" type="text" style="width: '+(Number(me.width())-14)+'px; height: '+(Number(me.height()))+'">'+value+'</textarea>';me.html(html);setTimeout(event,0);$(nameVo.inputSelector).focus();$(nameVo.inputSelector).bind('focusout',function(){callback($(this),nameVo)});$(nameVo.inputSelector).bind(eventString,function(event){if(event.keyCode==13){callback($(this),nameVo)}else if(event.keyCode==27){me.html('<pre>'+htmlChars(value)+'</pre>')}})})};jtown.admin.autoInterestOne=function(){var eventString=$.browser.chrome?'keydown':'keypress';var categoryPn='';$('#jt-partnership-interest-input').unbind(eventString).bind(eventString,function(event){if(event.keyCode===$.ui.keyCode.TAB&&$(this).data('ui-autocomplete').menu.active){event.preventDefault()}if(categoryPn==''){var parent=$(this).parents('.jt-partnership-info');categoryPn=parent.find('.jt-partnership-category-select').val()}}).autocomplete({minLength:0,source:function(request,response){var url=contextPath+'admin/ajax/autoInterestSection.jt',json={'categoryPn':categoryPn,'name':request.term};$.postJSON(url,json,function(interestes){var data=[];for(var i=0,len=interestes.length;i<len;i++){var interest=interestes[i];data[i]={label:interest.name,value:interest.name}}response(data)})},focus:function(){return false},select:function(event,ui){var terms=split(this.value);terms.pop();terms.push(ui.item.value);terms.push('');this.value=terms.join(',');return false}})};if(typeof jtown=='undefined'){jtown={}}if(typeof jtown.seller=='undefined'){jtown.seller={}}$(function(){jtown.seller.syncPopup();jtown.seller.startIntro();jtown.seller.markIntro();jtown.seller.syncIntro();jtown.seller.syncMainNotice();jtown.seller.syncMainImage();jtown.seller.syncProduct();jtown.seller.syncEvent();jtown.seller.syncExpandNotice();$('#jt-event-second-image').uploadify({'formData':{'pn':$('#jt-seller-body').attr('data-spn')},'buttonText':'사진 업로드','fileTypeDesc':'Image Files','fileTypeExts':'*.gif; *.jpg; *.png','fileSizeLimit':'5MB','multi':false,'swf':contextPath+'resources/uploadify/uploadify.swf','uploader':contextPath+'file/upload.jt','itemTemplate':'<div></div>','onUploadSuccess':function(file,data,response){jtown.seller.secondEvent(eval('('+data+')'))}});$('#jt-event-first-image').uploadify({'formData':{'pn':$('#jt-seller-body').attr('data-spn')},'buttonText':'사진 업로드','fileTypeDesc':'Image Files','fileTypeExts':'*.gif; *.jpg; *.png','fileSizeLimit':'5MB','multi':false,'swf':contextPath+'resources/uploadify/uploadify.swf','uploader':contextPath+'file/upload.jt','itemTemplate':'<div></div>','onUploadSuccess':function(file,data,response){jtown.seller.firstEvent(eval('('+data+')'))}});$('#jt-represent-image').uploadify({'formData':{'pn':$('#jt-seller-body').attr('data-spn')},'buttonText':'사진 업로드','method':'post','fileTypeDesc':'Image Files','fileTypeExts':'*.gif; *.jpg; *.png','fileSizeLimit':'5MB','multi':false,'swf':contextPath+'resources/uploadify/uploadify.swf','uploader':contextPath+'file/upload.jt','itemTemplate':'<div></div>','onUploadSuccess':function(file,data,response){jtown.seller.mainImage(eval('('+data+')'))}});$('#jt-product-file').uploadify({'formData':{'pn':$('body').attr('data-spn')},'buttonClass':'uploadify-plus-insert-btn','buttonText':'<img src="'+contextPath+'resources/images/jt-cloth-icon.png'+'" style="float:left; margin:9px 7px 0 10px"/><span style="float:left; ">상품추가</span>','height':'30','width':'90','fileTypeDesc':'Image Files','fileTypeExts':'*.gif; *.jpg; *.png','fileSizeLimit':'5MB','swf':contextPath+'resources/uploadify/uploadify.swf','uploader':contextPath+'file/upload.jt','itemTemplate':'<div></div>','errorMsg':'','onUploadSuccess':function(file,data,response){jtown.seller.productImage(eval('('+data+')'))}});$('#jt-product-finish').unbind('click').bind('click',function(){window.opener.document.location.reload();window.close()});$('#jt-tag-update-show-btn').toggle(function(){var url=contextPath+'ajax/seller/selectInterestes.jt',json={};$.postJSON(url,json,function(interestes){var html='';for(var i=0,iLen=interestes.length;i<iLen;i++){var interest=interestes[i];var checked=nullValueCheck(interest.sellerPn)?'':'checked="checked"';html+='<li><input type="checkbox" '+checked+' name="jt-tag-check" class="jt-tag-check" value="'+interest.sectionPn+'"/><label for="jt-tag-check">'+htmlChars(interest.name)+'</label></li>'}$('#jt-tag-checkBox-section>ul').html(html);$('#jt-tag-checkBox').show();setTimeout('jtown.seller.changeTag()',0);setTimeout('jtown.seller.changeTagIntro();',0)})},function(){$('#jt-tag-checkBox').hide();setTimeout('jtown.seller.changeTagIntro();',0)})});jtown.seller.changeTag=function(){$('.jt-tag-check').unbind('click').bind('click',function(){var checkedList=$('input:checkbox[name=jt-tag-check]:checked');if(checkedList.length>5){$(this).each(function(){this.checked=false});$('#jt-checkBox-header-text').css('color','#ff3600')}else{$('#jt-checkBox-header-text').css('color','#808080')}});$('#jt-tag-update-btn').unbind('click').bind('click',function(){var checkedList=$('input:checkbox[name=jt-tag-check]:checked');var spnList=new Array(checkedList.length);for(var i=0,cLen=checkedList.length;i<cLen;i++){var checked=checkedList[i];spnList[i]=checked.value}var url=contextPath+'ajax/seller/updateSellerInterestes.jt';var json={spnList:spnList};$.postJSON(url,json,function(interestes){$('#jt-seller-tag-content>span').remove();var html='';for(var i=0,iLen=interestes.length;i<iLen;i++){var interest=interestes[i];html+='<span>'+interest.name;if((i+1)!=iLen){html+=', '}html+='</span>'}$('#jt-tag-update-show-btn').before(html);$('#jt-tag-checkBox').hide();setTimeout('jtown.seller.changeTagIntro();',0)})});$('#jt-tag-cancle-btn').unbind('click').bind('click',function(){$('#jt-tag-checkBox').hide();setTimeout('jtown.seller.changeTagIntro();',0)})};jtown.seller.changeTagIntro=function(){var height=Number($('#step2').height())+20;$('.introjs-helperLayer').height(height)};makeIntro=function(){var intro=introJs();intro.setOptions({steps:[{element:'#step1',intro:'ShopNo : 고객고유번호<br/> Seller : 회사명 <br/>Site : 홈페이지주소<br/>'+'<span style="color : #ff431e;">위 정보는 고유정보 임으로 바꾸시려면 <a href="'+contextPath+'help/question" style="text-decoration:underline; color:#ff431e;">고객센터</a>에 문의 해주시기 바랍니다.</span>'},{element:'#step2',intro:'<ol>'+'	<li>쇼핑몰 대표 태그 입니다.</li>'+'	<li><span class="jt-intro-order">1.</span><span class="jt-tag-update-intro">수정</span> 을 클릭합니다.</li>'+'	<li><span class="jt-intro-order">2.</span>자신이 원하는 Tag을 체크합니다.</li>'+'	<li><span class="jt-intro-order">3.</span>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#step3',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 사진 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>사진 업로드 버튼을 클릭하여 사진을 업로드 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#jt-seller-main-footer',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 내용 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>내용을 수정 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#step5',intro:'<ul>'+'	<li><span class="jt-home-shop-view jt-home-text-explain">VIEW</span> : 최근 일주일간 방문수</li>'+'	<li><span class="jt-home-shop-comment jt-home-text-explain jt-comment-text-explain">COMMENT</span> : 댓글 수</li>'+'	<li><span class="jt-home-shop-love jt-home-text-explain jt-love-text-explain">♥</span> : 하트 클릭 수</li>'+'</ul>'},{element:'#jt-home-expand-shop-notice',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 내용 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>내용을 수정 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#step7',intro:'소비자가 해당 상품을 클릭하면 입력된 상품 URL 로 이동됩니다. 입력되지 않았을 시에는 쇼핑몰 첫 페이지로 이동 됩니다. 입력은 다음 단계에서 간편하게 가능 합니다.'},{element:'#step8',intro:'\'+\' 버튼을 누르시고 당신의 상품을 알려보세요.'},{element:'#jt-seller-expand-event-first',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 사진 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>사진 업로드 버튼을 클릭하여 사진을 업로드 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'},{element:'#jt-seller-expand-event-second',intro:'<ol style="list-style: decimal; margin-left: 15px;">'+'	<li>마우스를 사진 위에 올립니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'	<li>사진 업로드 버튼을 클릭하여 사진을 업로드 합니다.</li>'+'	<li>수정 버튼을 클릭합니다.</li>'+'</ol>'}]});return intro};jtown.seller.syncIntro=function(){$('.jt-seller-text-content').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}});$('.jt-home-shop-content-fn').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}});$('.jt-home-expand-shop-expandProducts').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}});$('.jt-home-expand-shop-products').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}});$('.jt-seller-tag').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).find('.question-mark-wrap').hide()}})};jtown.seller.startIntro=function(){$('#showHow').unbind('click').bind('click',function(){makeIntro().start()});$('#showHowPopup').unbind('click').bind('click',function(){makePoupIntro().start()})};jtown.seller.markIntro=function(){$('.question-mark').unbind('click').bind('click',function(){$('.question-mark').addClass('question-mark-hide');var step=$(this).attr('data-step');makeIntro().goToStep(step).start().oncomplete(function(){jtown.seller.markIntro();$('.question-mark').removeClass('question-mark-hide')}).onexit(function(){jtown.seller.markIntro();$('.question-mark').removeClass('question-mark-hide')})})};jtown.seller.syncProduct=function(){$('.jt-home-expand-shop-expandProduct').unbind('mouseover mouseout');$('.jt-home-expand-shop-expandProduct').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).find('.jt-product-article-object-wrap').show()}else if(event.type=='mouseout'){$(this).find('.jt-product-article-object-wrap').hide()}});$('#jt-product-popup').unbind('click').bind('click',function(){var url=contextPath+'seller/products/'+$(this).attr('data-pn');var option='width=610, height=530, toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=no';window.open(url,'',option)})};jtown.seller.syncPopup=function(){$('.jt-product-article-object-img').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).children('.jt-seller-expand-product-delete-tool').show();$(this).children('.jt-product-article-object-wrap').show()}else if(event.type=='mouseout'){$(this).children('.jt-seller-expand-product-delete-tool').hide();$(this).children('.jt-product-article-object-wrap').hide()}});$('.jt-seller-product-delete').unbind('click');$('.jt-seller-product-delete').bind('click',function(){var pn=$(this).parents('li').attr('data-ppn');var form=document.forms['product'];form.pn.value=pn;form._method.value='delete';form.submit()});$('.jt-product-article-object-img').unbind('click').bind('click',function(){var active=$(this).hasClass('jt-product-active');if(active){$('.jt-product-article-update').hide();$('.jt-product-article-insert').show();$('.jt-product-article-object-img').removeClass('jt-product-active');return}var pn=$(this).attr('data-ppn'),name=$(this).attr('data-name'),price=$(this).attr('data-price'),url=$(this).attr('data-url');var form=document.forms['product'];form.pn.value=pn;form.name.value=nullValueCheck(name)?'':name;form.price.value=nullValueCheck(price)?'':price;form.url.value=nullValueCheck(url)?'':url;$('.jt-product-article-insert').hide();$('.jt-product-article-update').show();$('.jt-product-input-error').addClass('jt-product-input').removeClass('jt-product-input-error');$('.jt-product-error').text('');$('.jt-product-article-object-img').removeClass('jt-product-active');$(this).addClass('jt-product-active')});$('.jt-product-update-cancle').unbind('click').bind('click',function(){$('.jt-product-article-update').hide();$('.jt-product-article-insert').show();$('.jt-product-article-object-img').removeClass('jt-product-active')});$('.jt-product-update-submit').unbind('click').bind('click',function(){var form=document.forms['product'];form._method.value='put';form.submit();$('.jt-product-article-update').hide();$('.jt-product-article-insert').show();$('.jt-product-article-object-img').removeClass('jt-product-active')})};jtown.seller.changeExpandTextIntro=function(){var height=Number($('#jt-home-expand-shop-notice').height())+20;$('.introjs-helperLayer').height(height)};jtown.seller.syncExpandNotice=function(){$('#jt-home-expand-shop-notice').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){var display=$('#jt-seller-expand-notice-update-tool').css('display');if(display=='none'){if(event.type=='mouseover'){$('#jt-seller-expand-notice-hover-tool').show();$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$('#jt-seller-expand-notice-hover-tool').hide();$(this).find('.question-mark-wrap').hide()}}});$('#jt-seller-expand-notice-updateShow').unbind('click').bind('click',function(){$('#jt-seller-expand-notice-hover-tool').hide();$('#jt-seller-expand-shop-text').hide();$('#jt-seller-expand-notice-update-tool').show();$('#jt-seller-expand-textarea').show();setTimeout('jtown.seller.changeExpandTextIntro();',0)});$('#jt-seller-expand-notice-update').unbind('click').bind('click',function(){$('#jt-seller-expand-notice-update-tool').hide();var url=contextPath+'ajax/seller/changeLongNotice.jt',longNotice=$('#jt-seller-expand-textarea').val(),json={'longNotice':longNotice};$.postJSON(url,json,function(){return jQuery.ajax({'success':function(){$('#jt-seller-expand-textarea').hide();$('#jt-seller-expand-shop-text').html(longNotice).show();setTimeout('jtown.seller.changeExpandTextIntro();',0)},'error':function(){$('#jt-seller-expand-textarea').hide();$('#jt-seller-expand-shop-text').show();setTimeout('jtown.seller.changeExpandTextIntro();',0);jtown.dialog('오류발생')}})})});$('#jt-seller-expand-notice-cancle').unbind('click').bind('click',function(){$('#jt-seller-expand-notice-update-tool').hide();$('#jt-seller-expand-textarea').hide().val($('#jt-seller-expand-shop-text').html());$('#jt-seller-expand-shop-text').show();setTimeout('jtown.seller.changeExpandTextIntro();',0)})};jtown.seller.changeMainTextIntro=function(){var height=Number($('#jt-seller-main-footer').height())+20;$('.introjs-helperLayer').height(height)};jtown.seller.syncMainNotice=function(){$('#jt-seller-main-footer').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){var display=$('#jt-seller-main-notice-update-tool').css('display');if(display=='none'){if(event.type=='mouseover'){$('#jt-seller-main-notice-hover-tool').show();$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$('#jt-seller-main-notice-hover-tool').hide();$(this).find('.question-mark-wrap').hide()}}});$('#jt-seller-main-notice-updateShow').unbind('click').bind('click',function(){$('#jt-seller-main-notice-hover-tool').hide();$('#jt-seller-main-footer-text').hide();$('#jt-seller-main-notice-update-tool').show();$('#jt-seller-main-textarea').show();setTimeout('jtown.seller.changeMainTextIntro()')});$('#jt-seller-main-notice-update').unbind('click').bind('click',function(){$('#jt-seller-main-notice-update-tool').hide();var url=contextPath+'ajax/seller/changeNotice.jt',notice=$('#jt-seller-main-textarea').val(),json={'notice':notice};$.postJSON(url,json,function(){return jQuery.ajax({'success':function(){$('#jt-seller-main-textarea').hide();$('#jt-seller-main-footer-text').html(notice).show();setTimeout('jtown.seller.changeMainTextIntro()')},'error':function(){$('#jt-seller-main-textarea').hide();$('#jt-seller-main-footer-text').show();setTimeout('jtown.seller.changeMainTextIntro()');jtown.dialog('오류발생')}})})});$('#jt-seller-main-notice-cancle').unbind('click').bind('click',function(){$('#jt-seller-main-notice-update-tool').hide();$('#jt-seller-main-textarea').hide().val($('#jt-seller-main-footer-text').html());$('#jt-seller-main-footer-text').show();setTimeout('jtown.seller.changeMainTextIntro()')})};jtown.seller.syncMainImage=function(){$('#jt-seller-main-image').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){var display=$('#jt-seller-main-image-update-tool').css('display');if(display=='none'){if(event.type=='mouseover'){$('#jt-seller-main-image-hover-tool').show();$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$('#jt-seller-main-image-hover-tool').hide();$(this).find('.question-mark-wrap').hide()}}});$('#jt-seller-main-image-updateShow').unbind('click').bind('click',function(){$('#jt-seller-main-image-hover-tool').hide();$('#jt-seller-main-image-update-tool').show();setTimeout('jtown.seller.changeMainBgHeight()',0)});$('#jt-seller-main-image-update').unbind('click').bind('click',function(){$('#jt-seller-main-image-update-tool').hide();jtown.seller.mainImageUpdate()});$('#jt-seller-main-image-cancle').unbind('click').bind('click',function(){$('#jt-seller-main-image-update-tool').hide();jtown.seller.mainImageCancle()})};jtown.seller.changeMainBgHeight=function(){var height=$('#jt-seller-main-image').height();$('#jt-seller-main-image-update-tool').height(height);height=Number(height)+20;$('.introjs-helperLayer').height(height)};jtown.seller.mainImage=function(file){var oldSrc=$('#jt-seller-main-image-area').attr('src'),newSrc=contextPath+'resources/uploadImage/'+file.saveName,oldSrcObject=$('#jt-seller-main-image-area').attr('data-oldSrc');$('#jt-seller-main-image-area').attr('src',newSrc).attr('data-imagePn',file.imagePn);if(nullValueCheck(oldSrcObject)){$('#jt-seller-main-image-area').attr('data-oldSrc',oldSrc)}setTimeout('jtown.seller.changeMainBgHeight()',100)};jtown.seller.mainImageUpdate=function(){var url=contextPath+'ajax/seller/changeMainImage.jt',json={'imagePn':$('#jt-seller-main-image-area').attr('data-imagePn')};$.postJSON(url,json,function(){return jQuery.ajax({'success':function(){$('#jt-seller-main-image-area').attr('data-oldSrc','').attr('data-imagePn','')},'error':function(){jtown.dialog("오류 발생!")}})})};jtown.seller.mainImageCancle=function(){var oldSrc=$('#jt-seller-main-image-area').attr('data-oldSrc');$('#jt-seller-main-image-area').attr('src',oldSrc).attr('data-oldSrc','').attr('data-imagePn','');$('#representImageForm #filedata').val('')};jtown.seller.productImage=function(file){var url=contextPath+'ajax/seller/insertProduct.jt',json={'imagePn':file.imagePn,'saveName':file.saveName};$.postJSON(url,json,function(product){if(product.count>9){jtown.dialog('상품은 10개 이하로 등록 가능합니다.')}var me=$('#jt-product-article-object-'+product.count);me.children('img').attr('src',contextPath+'resources/uploadImage/'+product.saveName);me.addClass('jt-product-article-object-img');me.attr('data-ppn',product.pn);jtown.seller.syncPopup()})};jtown.seller.syncEvent=function(){$('#jt-seller-expand-event-first, #jt-seller-expand-event-second').unbind('mouseover mouseout');$('#jt-seller-expand-event-first, #jt-seller-expand-event-second').bind('mouseover mouseout',function(event){if($(this).children('.jt-home-expand-shop-event-update-wrap').css('display')=='none'){if(event.type=='mouseover'){$(this).children('.jt-home-expand-shop-event-tool').show();$(this).find('.question-mark-wrap').show()}else if(event.type=='mouseout'){$(this).children('.jt-home-expand-shop-event-tool').hide();$(this).find('.question-mark-wrap').hide()}}});$('.jt-home-expand-shop-event-tool').unbind('click').bind('click',function(){$(this).parents('.jt-home-expand-shop-event').children('.jt-home-expand-shop-event-tool').hide();$(this).parents('.jt-home-expand-shop-event').children('.jt-home-expand-shop-event-update-wrap').show()});$('.jt-home-expand-shop-event-update-cancle').unbind('click').bind('click',function(){var $parent=$(this).parents('.jt-home-expand-shop-event');var $img=$parent.find('img');var oldSrc=$img.attr('data-oldSrc');$img.attr('src',oldSrc).attr('data-oldSrc','').attr('data-imagePn','');$parent.find('input[type=file]').val('');$parent.children('.jt-home-expand-shop-event-update-wrap').hide()});$('.jt-home-expand-shop-event-update-done').unbind('click').bind('click',function(){var $parent=$(this).parents('.jt-home-expand-shop-event');var $img=$parent.find('img'),imagePn=$img.attr('data-imagePn');if(!nullValueCheck(imagePn)){var url=contextPath+'ajax/seller/changeEvent.jt',json={'imagePn':imagePn,'pn':$parent.attr('data-epn'),'bannerOrder':$parent.attr('data-bo')};$.postJSON(url,json,function(){$img.attr('data-oldSrc','').attr('data-imagePn','');$parent.children('.jt-home-expand-shop-event-update-wrap').hide();var html='<div class="jt-home-expand-shop-event-new">'+'<div>'+'<span class="jt-home-expand-shop-event-new-image">NEW</span>'+'</div>'+'</div>';$parent.prepend(html)})}else{$img.attr('data-oldSrc','').attr('data-imagePn','');$parent.children('.jt-home-expand-shop-event-update-wrap').hide()}})};jtown.seller.firstEvent=function(file){var oldSrc=$('#jt-seller-expand-event-first-img').attr('src'),newSrc=contextPath+'resources/uploadImage/'+file.saveName,oldSrcObject=$('#jt-seller-expand-event-first-img').attr('data-oldSrc');$('#jt-seller-expand-event-first-img').attr('src',newSrc).attr('data-imagePn',file.imagePn);if(nullValueCheck(oldSrcObject)){$('#jt-seller-expand-event-first-img').attr('data-oldSrc',oldSrc)}};jtown.seller.secondEvent=function(file){var oldSrc=$('#jt-seller-expand-event-second-img').attr('src'),newSrc=contextPath+'resources/uploadImage/'+file.saveName,oldSrcObject=$('#jt-seller-expand-event-second-img').attr('data-oldSrc');$('#jt-seller-expand-event-second-img').attr('src',newSrc).attr('data-imagePn',file.imagePn);if(nullValueCheck(oldSrcObject)){$('#jt-seller-expand-event-second-img').attr('data-oldSrc',oldSrc)}};$(function(){jtown.expand.loadExpandShop();jtown.expand.syncProductMove();jtown.comment.syncComment();jtown.expand.gotoPage()});if(typeof jtown.expand=='undefined'){jtown.expand={}}jtown.expand.show=true;jtown.expand.loadExpandShop=function(){$('.jt-home-shop-content-image').unbind('click').bind('click',function(){var parent=$(this).parents('.jt-seller-main');if(nullValueCheck(parent.html())){var jtHomeShop=$(this).parents('.jt-home-shop'),spn=jtHomeShop.attr('data-spn');jtown.expand.makeInnerHtml(spn)}});$('.jt-home-shop-comment').unbind('click').bind('click',function(){var $parent=$(this).parents('.jt-seller-main');if(nullValueCheck($parent.html())){var jtHomeShop=$(this).parents('.jt-home-shop'),spn=jtHomeShop.attr('data-spn');jtown.expand.makeInnerHtml(spn)}})};jtown.expand.makeInnerHtml=function(spn){var url=contextPath+'ajax/home/expandShop.jt',json={'pn':spn};$.postJSON(url,json,function(selectMap){var html='';var path=contextPath+'resources/uploadImage/';var event1=selectMap.event1,event2=selectMap.event2,products=selectMap.products,jtownUser=selectMap.jtownUser,comments=selectMap.comments,commentTops=selectMap.commentTops,commentFilter=selectMap.commentFilter,interests=selectMap.interestes,cpn=selectMap.cpn,best=false,loveHave=selectMap.loveHave;var productSize=Number(products.length);var bigProductHtml='';var smallProductHtml='';for(var i=0;i<productSize;i++){var product=products[i],index=productSize-Number(i);var detailProduct='<span>'+htmlChars(nullValueCheck(product.name)?'':product.name)+'</span>';detailProduct+='<span>'+htmlChars(nullValueCheck(product.commaPrice)?'':product.commaPrice)+'</span>';if(nullValueCheck(product.name)||nullValueCheck(product.commaPrice)){detailProduct='<span>상품 정보가 아직</span><span>입력되지 않았습니다.</span>'}bigProductHtml+='<div class="jt-home-expand-shop-expandProduct">';bigProductHtml+='<a href="'+(nullValueCheck(product.url)?jtownUser.shopUrl:product.url)+'" target="_blank" onclick="jtown.home.goHome('+spn+');"><img alt="상품" src="'+path+product.saveName+'"/></a>';bigProductHtml+='<div class="jt-product-article-object-wrap jt-product-article-object-expand">';bigProductHtml+=detailProduct;bigProductHtml+='</div>';bigProductHtml+='</div>';var smallProductNewHtml='<span>&nbsp;</span>';if(product.newProduct){smallProductNewHtml='<span>New</span>'}smallProductHtml+='<li data-count="'+index+'">';smallProductHtml+='	'+smallProductNewHtml;smallProductHtml+='	<a href="#none" class="jt-product-list"><img alt="상품" src="'+path+product.saveName+'"/></a>';smallProductHtml+='</li>'}var eventImage1=contextPath+'resources/images/jt-event-user-blank.png',eventImage2=contextPath+'resources/images/jt-event-user-blank.png';if(!nullValueCheck(event1)){eventImage1=path+event1.saveName}if(!nullValueCheck(event2)){eventImage2=path+event2.saveName}var commentHtml='';if(commentTops.length>0){comments=commentTops;best=true}var cancleHtml='&nbsp;<a href="#none" class="jt-home-expand-shop-comment-loveIt-cancle">취소</a>';for(var i=0;i<comments.length;i++){var comment=comments[i];var cancleComment=nullValueCheck(comment.commentCustomerPn)?'':cancleHtml;var warnComment='';if(comment.customerPn!=cpn){if(nullValueCheck(comment.warnCustomerPn)){warnComment='&nbsp;<span href="#none" class="jt-warn-active" title="신고">WARN</span>'}else{warnComment='&nbsp;<span href="#none" class="jt-warn-disactive" title="신고">WARN</span>'}}commentHtml+='<li data-copn="'+comment.commentPn+'" class="'+(best?'jt-home-expand-shop-comment-li-best':'jt-home-expand-shop-comment-li')+'">';commentHtml+='	<ul class="jt-home-expand-shop-text-wrap">';if(best){commentHtml+='		<li class="jt-home-expand-shop-comment-header">';commentHtml+='			<span class="jt-home-expand-shop-comment-best">BEST</span>';commentHtml+='		</li>'}commentHtml+='		<li class="jt-home-expand-shop-comment-content">';commentHtml+='			<span class="jt-home-expand-shop-comment-name">'+htmlChars(comment.customerName)+'</span>';commentHtml+=' 			<span class="jt-home-expand-shop-comment-text">'+htmlChars(comment.comment)+'</span>';commentHtml+='		</li>';commentHtml+='		<li class="copnLoveIt-'+comment.commentPn+' jt-home-expand-shop-comment-footer">';commentHtml+='			<span class="jt-home-expand-shop-comment-progress-date">'+comment.inputDate+'</span>';commentHtml+=' 			<a href="#none" class="jt-home-expand-shop-comment-loveIt">LOVE</a>';commentHtml+='			<span class="jt-home-expand-shop-comment-loveIt-count">'+(nullValueCheck(comment.commentLoveCount)?'':comment.commentLoveCount)+'</span>'+cancleComment;commentHtml+='			'+warnComment;commentHtml+='		</li>';commentHtml+='	</ul>';if(comment.customerPn==cpn){commentHtml+='<div class="jt-home-expand-shop-update-wrap">';commentHtml+='	<input type="text" class="jt-comment-update-input" value="'+htmlChars(comment.comment)+'" maxlength="100"><br/>';commentHtml+='	<span>esc를 누르시면 수정이 취소 됩니다.</span>';commentHtml+='</div>';commentHtml+='<div class="jt-home-expand-shop-tool-wrap">';commentHtml+='	<a href="#none" class="jt-comment-update jt-btn-white-small">';commentHtml+='		<span class="btnImage"></span>';commentHtml+='	</a>';commentHtml+='	<a href="#none" class="jt-comment-delete jt-btn-white-small">';commentHtml+='		<span class="btnImage"></span>';commentHtml+='	</a>';commentHtml+='</div>'}commentHtml+='</li>'}var pagination=commentFilter.pagination;if(commentTops.length>0){if(pagination.numItems>0){commentHtml+='<li class="jt-home-expand-shop-comment-add">';commentHtml+='	<a href="#none" class="jt-btn-silver" id="comment-add-btn"';commentHtml+='		data-spn="'+jtownUser.pn+'" data-page="0" ';commentHtml+='		data-ni="'+pagination.numItems+'" data-nipp="'+pagination.numItemsPerPage+'">';commentHtml+='			댓글&nbsp;더&nbsp;보기&nbsp;<span id="comment-now-count">0</span>/'+pagination.numItems;commentHtml+='	</a>';commentHtml+='</li>'}}else{if(pagination.numItems>pagination.numItemsPerPage){commentHtml+='<li class="jt-home-expand-shop-comment-add">';commentHtml+='	<a href="#none" class="jt-btn-silver" id="comment-add-btn"';commentHtml+='		data-spn="'+jtownUser.pn+'" data-page="1" ';commentHtml+='		data-ni="'+pagination.numItems+'" data-nipp="'+pagination.numItemsPerPage+'">';commentHtml+='			댓글&nbsp;더&nbsp;보기&nbsp;<span id="comment-now-count">'+pagination.numItemsPerPage+'</span>/'+pagination.numItems;commentHtml+='	</a>';commentHtml+='</li>'}}var commentInputHtml='';if(cpn==0){commentInputHtml+='<input id="jt-comment-insert" readonly="readonly" placeholder="판매자 아이디로는 이용하실 수 없습니다."/>'}else if(!nullValueCheck(cpn)){commentInputHtml+='<input type="text" id="jt-comment-insert" placeholder="쇼핑몰에 대한 한마디를 남겨보세요. 상품 배송문의는 해당 쇼핑몰 고객센터로 남겨주세요." maxlength="100"/>'}else{commentInputHtml+='<input id="jt-comment-insert" readonly="readonly" placeholder="로그인한 사용자만 사용할 수 있습니다."/>'}var newEventHtml='';newEventHtml+='		<div class="jt-home-expand-shop-event-new">';newEventHtml+='			<div>';newEventHtml+='				<span class="jt-home-expand-shop-event-new-image">NEW</span>';newEventHtml+='			</div>';newEventHtml+='		</div>';var loveClick=(!nullValueCheck(loveHave)&&loveHave!=0)?'jt-home-shop-love-click':'';var loveTextClick=(!nullValueCheck(loveHave)&&loveHave!=0)?'jt-home-shop-love-text-click':'';var loveHotCount='<span class="jt-home-shop-love-hot" title="최근 뜨는 미니샵">HOT</span>';if(nullValueCheck(jtownUser.loveHotCount)||jtownUser.loveHotCount==0){loveHotCount=''}var tagHtml='<span class="tag-txt">';for(var i=0,iLength=interests.length;i<iLength;i++){var interest=interests[i];tagHtml+=interest.name;if((i+1)!=iLength){tagHtml+=',&nbsp;'}}tagHtml+='</span><span class="tag-image">Tag</span>';html+='<header class="jt-home-expand-click-shop-header">';html+='	<div>';html+='		<a href="'+jtownUser.shopUrl+'" target="_blank" onclick="jtown.home.goHome(\''+spn+'\');" title="클릭시 해당 쇼핑몰로 이동됩니다.">'+htmlChars(jtownUser.name)+'</a>';html+='	</div>';html+='</header>';html+='<div class="jt-home-expand-shop jt-home-expand-click-shop" id="jt-home-expand-shop" data-name="'+htmlChars(jtownUser.name)+'" data-size="'+productSize+'" data-nowPosition="'+productSize+'" data-spn="'+jtownUser.pn+'" data-url="'+jtownUser.shopUrl+'">';html+='	<div id="jt-home-expand-shop-notice" class="gotoPage" title="클릭시 해당 쇼핑몰로 이동됩니다.">';html+='		<span class="jt-home-expand-shop-firstQuotationMark"></span>';html+='		<pre id="jt-seller-expand-shop-text" class="jt-home-expand-shop-text">'+(nullValueCheck(jtownUser.longNotice)?"쇼핑몰의 홍보문구를 입력해주세요.":jtownUser.longNotice)+'</pre>';html+='		<span class="jt-home-expand-shop-lastQuotationMark"></span>';html+='	</div>';html+='	<ul class="jt-home-expand-shop-expandProducts">';html+='		<li class="jt-home-expand-shop-leftArrow jt-home-expand-shop-arrow">';if(productSize>3){html+='			<a href="#none" id="jt-home-expand-shop-leftArrow">&lt;</a>'}html+='		</li>';html+='		<li class="jt-home-expand-shop-expandProduct-slide" id="jt-seller-slide-big">';html+='			<div id="jt-seller-slide-fake-dan">';html+='				<div style="width : '+(Number(productSize)*170)+'px;" id="jt-seller-slide-content-dan">';html+='					'+bigProductHtml;html+='				</div>';html+='			</div>';html+='		</li>';html+='		<li class="jt-home-expand-shop-rigthArrow jt-home-expand-shop-arrow">';if(productSize>3){html+='			<a href="#none" id="jt-home-expand-shop-rigthArrow">&gt;</a>'}html+='		</li>';html+='	</ul>';html+='	<div class="jt-home-expand-shop-products ">';html+='		<ul id="jt-seller-slide-small">';html+='			'+smallProductHtml;html+='		</ul>';html+='		<div class="jt-home-expand-shop-tag">';html+='			'+tagHtml;html+='		</div>';html+='	</div>';html+='	<div class="jt-home-expand-shop-event gotoPage" id="jt-seller-expand-event-first" title="클릭시 해당 쇼핑몰로 이동됩니다.">';html+='		'+((jtownUser.bannerFirst!=null&&Number(jtownUser.bannerFirst)<3)?newEventHtml:'');html+='		<img alt="First Event" src="'+eventImage1+'"/>';html+='	</div>';html+='	<div class="jt-home-expand-shop-event gotoPage" id="jt-seller-expand-event-second" title="클릭시 해당 쇼핑몰로 이동됩니다.">';html+='		'+((jtownUser.bannerSecond!=null&&Number(jtownUser.bannerSecond)<3)?newEventHtml:'');html+='		<img alt="Second Event" src="'+eventImage2+'"/>';html+='	</div>';html+='	<ul class="jt-home-expand-shop-content-fn">';html+='		<li class="jt-home-expand-shop-content-view-wrap">';html+='			<span class="jt-home-expand-shop-content-view" title="최근 일주일간 방문수">Look</span>&nbsp;<span id="view-expand-'+spn+'">'+jtownUser.viewCount+'</span>';html+='		</li>';html+='		<li class="jt-home-expand-shop-content-comment-wrap">';html+='			<span class="jt-home-expand-shop-content-comment"></span>&nbsp;Comment&nbsp;<span id="comment-expand-'+spn+'" class="jt-home-expand-shop-content-comment-text">'+jtownUser.commentCount+'</span>';html+='			<div class="jt-home-expand-shop-border-hide"></div>';html+='		</li>';html+='		<li class="jt-home-expand-shop-content-love-wrap">';html+='			<div class="jt-heart-click-expand-wrap">';html+='				<div class="jt-heart-click-background" id="jt-heart-expand-click-'+spn+'">';html+='					<img alt="heart-background" src="'+contextPath+'resources/images/heart-background.png">';html+='				</div>';html+='				<div class="jt-heart-click">';html+='					<a href="#none" onclick="jtown.home.clickLove(\''+spn+'\');"><span class="jt-home-expand-shop-content-love '+loveClick+'" id="love-expand-image-'+spn+'">Love</span></a>';html+='				</div>';html+='			</div>';html+='			<div class="jt-home-expand-shop-content-love-text-wrap">';html+='				<span id="love-expand-'+spn+'" class="'+loveTextClick+'">'+jtownUser.loveCount+'</span>';html+='				'+loveHotCount;html+='			</div>';html+='		</li>';html+='	</ul>';html+='	<div class="jt-home-expand-shop-comment-wrap">';html+='		<ul class="jt-home-expand-shop-comment">';html+='			'+commentHtml;html+='		</ul>';html+='		<div class="jt-home-expand-shop-comment-insert">';html+='			'+commentInputHtml;html+='		</div>';html+='	</div>';html+='</div>';$.smartPop.open({width:640,height:650,html:html,effect:'transfer',target:'#jt-home-shop-'+spn});setTimeout('jtown.expand.setTimeout()',0);setTimeout('jtown.home.clickShop(\''+spn+'\');',0)})};jtown.expand.setTimeout=function(){jtown.expand.show=true;jtown.expand.syncProductMove();jtown.comment.syncComment();jtown.expand.changeContainerHeight();jtown.expand.gotoPage();jtown.seller.syncProduct();$(function(){$('#jt-comment-insert').placeholder()})};jtown.expand.gotoPage=function(){$('.gotoPage').unbind('click').bind('click',function(){var parent=$(this).parents('.jt-home-expand-shop');var spn=parent.attr('data-spn');var url=parent.attr('data-url');var open=window.open('about:blank');open.location.href=url;jtown.home.goHome(spn)})};jtown.expand.changeContainerHeight=function(){var smartPopContainer=$('#smartPop_container');if(!nullValueCheck(smartPopContainer.html())){var smartPopContent=$('#smartPop_content');var height=$('#jt-home-expand-shop').css('height');height=Number(height.replace('px',''));var changeHeight=height+50;smartPopContainer.css('height',changeHeight+'px');smartPopContent.css('height',changeHeight+'px')}};jtown.expand.syncProductMove=function(){$('.jt-product-list').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){if(event.type=='mouseover'){$(this).css('opacity','.7')}else if(event.type=='mouseout'){$(this).css('opacity','1')}});activeLeftArrow=function(){var s;$('#jt-home-expand-shop-leftArrow').unbind('click').bind('click',function(){clearTimeout(s);a=function(){var last=$('#jt-seller-slide-content-dan>div:last'),dan=$('#jt-seller-slide-content-dan'),parent=$('#jt-home-expand-shop'),size=Number(parent.attr('data-size')),np=Number(parent.attr('data-nowPosition'));if(size>3){dan.prepend(last.clone().wrapAll('<div/>').parent().html());dan.css({left:'-170px'}).animate({left:'0px'},'500','swing');last.remove();parent.attr('data-nowPosition',(np+1)>size?1:(np+1));jtown.seller.syncProduct()}};s=setTimeout('a()',200)})};activeLeftArrow();activeRightArrow=function(){var s;$('#jt-home-expand-shop-rigthArrow').unbind('click').bind('click',function(){clearTimeout(s);a=function(){var first=$('#jt-seller-slide-content-dan>div:first'),dan=$('#jt-seller-slide-content-dan'),parent=$('#jt-home-expand-shop'),size=Number(parent.attr('data-size')),np=Number(parent.attr('data-nowPosition'));if(size>3){dan.animate({left:'-170px'},'500','swing',function(){dan.css({left:'0px'});first.remove()});dan.append(first.clone().wrapAll('<div/>').parent().html());parent.attr('data-nowPosition',(np-1)<1?size:(np-1));jtown.seller.syncProduct()}};s=setTimeout('a()',200)})};activeRightArrow();activeProductList=function(){var s;$('.jt-product-list').unbind('click').bind('click',function(){$('.jt-product-list').unbind('click');$('#jt-home-expand-shop-rigthArrow').unbind('click');$('#jt-home-expand-shop-leftArrow').unbind('click');clearTimeout(s);var count=Number($(this).parents('li').attr('data-count'));a=function(){var last=$('#jt-seller-slide-content-dan>div:last'),dan=$('#jt-seller-slide-content-dan'),parent=$('#jt-home-expand-shop'),size=Number(parent.attr('data-size')),np=Number(parent.attr('data-nowPosition'));if((np==1&&size==count)||(count!=size&&(count+1)==np)){activeProductList();activeLeftArrow();activeRightArrow();return}if(size>3){if(count!=np){if(jtown.expand.show){setTimeout('a()',500)}}else{activeProductList();activeLeftArrow();activeRightArrow()}dan.prepend(last.clone().wrapAll('<div/>').parent().html());dan.css({left:'-170px'}).animate({left:'0px'},'500','swing');last.remove();parent.attr('data-nowPosition',(np+1)>size?1:(np+1));jtown.seller.syncProduct()}};s=setTimeout('a()',500)})};activeProductList()};if(typeof jtown.comment=='undefined'){jtown.comment={}}jtown.comment.syncComment=function(){var eventString=$.browser.chrome?'keydown':'keypress';$('#jt-comment-insert').unbind(eventString).bind(eventString,function(event){if(event.keyCode==13){jtown.comment.insertComment($(this))}});$('#jt-comment-insert').unbind('click').bind('click',function(){var $parent=$(this).parents('#jt-home-expand-shop'),spn=$parent.attr('data-spn'),name=$parent.attr('data-name');var url=contextPath+'ajax/home/existComment.jt',json={sellerPn:spn};$.postJSON(url,json,function(map){var result=map.result,authoriy=map.authority;if(authoriy!='CUSTOMER'){$('#jt-comment-insert').unbind('click');return}if(result){$('#jt-comment-insert').attr('readonly','readonly');jtown.dialog(name+' 쇼핑몰에 대한 댓글은<br/>하루에 한번만 가능합니다.')}else{$('#jt-comment-insert').removeAttr('readonly')}})});$('.jt-comment-delete').unbind('click').bind('click',function(){var me=$(this);jtown.confirm('댓글을 삭제하시겠습니까?',function(){jtown.comment.deleteComment(me)},function(){})});$('.jt-comment-update').unbind('click').bind('click',function(){var $parents=$(this).parents('li');$parents.find('.jt-home-expand-shop-tool-wrap').hide();$parents.find('.jt-home-expand-shop-text-wrap').hide();$parents.find('.jt-home-expand-shop-update-wrap').show();setTimeout('jtown.expand.changeContainerHeight()',0)});$('.jt-comment-update-input').unbind(eventString).bind(eventString,function(event){if(event.keyCode==13){jtown.comment.updateComment($(this))}else if(event.keyCode==27){jtown.comment.cancleComment($(this))}setTimeout('jtown.expand.changeContainerHeight()',0)});$('.jt-home-expand-shop-comment li').unbind('mouseover mouseout').bind('mouseover mouseout',function(event){var display=$(this).find('.jt-home-expand-shop-update-wrap').css('display');if(display!='block'){if(event.type=='mouseover'){$(this).find('.jt-home-expand-shop-tool-wrap').show()}else if(event.type=='mouseout'){$(this).find('.jt-home-expand-shop-tool-wrap').hide()}}});$('#comment-add-btn-best').unbind('click').bind('click',function(event){var me=$(this);var url=contextPath+'ajax/home/selectCommentBest.jt';var json={sellerPn:me.attr('data-spn')};$.postJSON(url,json,function(comments){for(var i=0,len=comments.length;i<len;i++){var comment=comments[i];jtown.comment.commentHtml(comment,'last',true)}setTimeout('jtown.comment.syncComment()',0);$('#comment-add-btn-best').parents('li').remove();$('#comment-add-btn').parents('li').show()})});$('#comment-add-btn').unbind('click').bind('click',function(event){var me=$(this),page=(Number(me.attr('data-page'))+1),nextPage=(page+1),numItemsPerPage=me.attr('data-nipp'),numItems=me.attr('data-ni');var url=contextPath+'ajax/home/selectComment.jt';var json={page:page,sellerPn:me.attr('data-spn')};$.postJSON(url,json,function(comments){for(var i=0,len=comments.length;i<len;i++){var comment=comments[i];jtown.comment.commentHtml(comment,'last',false)}setTimeout('jtown.expand.changeContainerHeight()',0);setTimeout('jtown.comment.syncComment()',0);if(nextPage*numItemsPerPage<numItems||(page*numItemsPerPage<numItems&&nextPage*numItemsPerPage>=numItems)){me.attr('data-page',page);$('#comment-now-count').html(page*numItemsPerPage)}else{me.parents('li').remove()}})});$('.jt-home-expand-shop-comment-loveIt').unbind('click').bind('click',function(){var me=$(this),parents=me.parents('.jt-home-expand-shop-comment-li'),$shop=me.parents('#jt-home-expand-shop');if(nullValueCheck(parents.html())){parents=me.parents('.jt-home-expand-shop-comment-li-best')}var commentPn=parents.attr('data-copn');var url=contextPath+'ajax/home/toggleCommentLove.jt';var json={commentPn:commentPn,sellerPn:$shop.attr('data-spn')};$.postJSON(url,json,function(comment){if(!nullValueCheck(comment.message)){switch(Number(comment.message)){case 1:jtown.header.showLoginForm();break;case 2:jtown.dialog('판매자는 불가능 합니다.');break;default:break}}else{var crudType=comment.crudType;if(crudType=='insert'){$('.copnLoveIt-'+commentPn+' .jt-home-expand-shop-comment-loveIt-count').after('<a href="#none" class="jt-home-expand-shop-comment-loveIt-cancle">&nbsp;취소</a>');jtown.comment.loveCancle()}else if(crudType=='delete'){$('.copnLoveIt-'+commentPn).find('.jt-home-expand-shop-comment-loveIt-cancle').remove()}}})});jtown.comment.loveCancle();$('.jt-warn-active').unbind('click').bind('click',function(){var me=$(this),parents=me.parents('.jt-home-expand-shop-comment-li');if(nullValueCheck(parents.html())){parents=me.parents('.jt-home-expand-shop-comment-li-best')}var commentPn=parents.attr('data-copn');var url=contextPath+'ajax/home/warnCommentLove.jt';var json={commentPn:commentPn};$.postJSON(url,json,function(comment){if(!nullValueCheck(comment.message)){jtown.dialog(comment.message)}else{me.removeClass('jt-warn-active').addClass('jt-warn-disactive').unbind('click')}})})};jtown.comment.loveCancle=function(){$('.jt-home-expand-shop-comment-loveIt-cancle').unbind('click').bind('click',function(){var me=$(this),parents=me.parents('.jt-home-expand-shop-comment-li'),shop=me.parents('#jt-home-expand-shop');if(nullValueCheck(parents.html())){parents=me.parents('.jt-home-expand-shop-comment-li-best')}var commentPn=parents.attr('data-copn');var url=contextPath+'ajax/home/toggleCommentLove.jt';var json={commentPn:commentPn,sellerPn:shop.attr('data-spn')};$.postJSON(url,json,function(comment){if(!nullValueCheck(comment.message)){jtown.header.showLoginForm()}else{var crudType=comment.crudType;if(crudType=='delete'){$('.copnLoveIt-'+commentPn).find('.jt-home-expand-shop-comment-loveIt-cancle').remove()}}})})};jtown.comment.commentHtml=function(comment,position,best){var cpn=$('#jt-logout').attr('data-cpn');var cancleHtml='&nbsp;<a href="#none" class="jt-home-expand-shop-comment-loveIt-cancle">취소</a>';var cancleComment=nullValueCheck(comment.commentCustomerPn)?'':cancleHtml;var warnComment='';if(comment.customerPn!=cpn){if(nullValueCheck(comment.warnCustomerPn)){warnComment='&nbsp;<span href="#none" class="jt-warn-active" title="신고">WARN</span>'}else{warnComment='&nbsp;<span href="#none" class="jt-warn-disactive" title="신고">WARN</span>'}}var commentHtml='';commentHtml+='<li data-copn="'+comment.commentPn+'" class="'+(best?'jt-home-expand-shop-comment-li-best':'jt-home-expand-shop-comment-li')+'">';commentHtml+='	<ul class="jt-home-expand-shop-text-wrap">';if(best){commentHtml+='		<li class="jt-home-expand-shop-comment-header">';commentHtml+='			<span class="jt-home-expand-shop-comment-best">BEST</span>';commentHtml+='		</li>'}commentHtml+='		<li class="jt-home-expand-shop-comment-content">';commentHtml+='			<span class="jt-home-expand-shop-comment-name">'+htmlChars(comment.customerName)+'</span>';commentHtml+=' 			<span class="jt-home-expand-shop-comment-text">'+htmlChars(comment.comment)+'</span>';commentHtml+='		</li>';commentHtml+='		<li class="copnLoveIt-'+comment.commentPn+' jt-home-expand-shop-comment-footer">';commentHtml+='			<span class="jt-home-expand-shop-comment-progress-date">'+comment.inputDate+'</span>';commentHtml+=' 			<a href="#none" class="jt-home-expand-shop-comment-loveIt">LOVE</a>';commentHtml+='			<span class="jt-home-expand-shop-comment-loveIt-count">'+(nullValueCheck(comment.commentLoveCount)?'':comment.commentLoveCount)+'</span>'+cancleComment;commentHtml+='			'+warnComment;commentHtml+='		</li>';commentHtml+='	</ul>';if(comment.customerPn==cpn){commentHtml+='	<div class="jt-home-expand-shop-update-wrap">';commentHtml+='		<input type="text" class="jt-comment-update-input" value="'+htmlChars(comment.comment)+'" maxlength="100"/><br/>';commentHtml+='		<span>esc를 누르시면 수정이 취소 됩니다.</span>';commentHtml+='	</div>';commentHtml+='	<div class="jt-home-expand-shop-tool-wrap">';commentHtml+='		<a href="#none" class="jt-comment-update jt-btn-white-small">';commentHtml+='			<span class="btnImage"></span>';commentHtml+='		</a>';commentHtml+='		<a href="#none" class="jt-comment-delete jt-btn-white-small">';commentHtml+='			<span class="btnImage"></span>';commentHtml+='		</a>';commentHtml+='	</div>'}commentHtml+='</li>';var innerHtml=$('.jt-home-expand-shop-comment-li:'+position).html();if(!nullValueCheck(innerHtml)){if(position=='last')$('.jt-home-expand-shop-comment-li:'+position).after(commentHtml);else if(position=='first')$('.jt-home-expand-shop-comment-li:'+position).before(commentHtml)}else{var innerBestHtml=$('.jt-home-expand-shop-comment-li-best:last').html();if(!nullValueCheck(innerBestHtml)){$('.jt-home-expand-shop-comment-li-best:last').after(commentHtml)}else{$('.jt-home-expand-shop-comment').prepend(commentHtml)}}};jtown.comment.insertComment=function(me){var $parent=me.parents('#jt-home-expand-shop'),spn=$parent.attr('data-spn'),name=$parent.attr('data-name'),comment=me.val();if(nullValueCheck(comment)){return}var url,json={'sellerPn':spn};url=contextPath+'ajax/home/existLove.jt';$.postJSON(url,json,function(result){postComment=function(){url=contextPath+'ajax/home/insertComment.jt';json.comment=comment;$.postJSON(url,json,function(comment){me.val('');me.attr('readonly','readonly')})};if(!result){jtown.comment.loveconfirm(function(){jtown.home.clickLove(spn);setTimeout('postComment()',0)},function(){postComment()},name)}else{postComment()}})};jtown.comment.loveconfirm=function(success,cancle,name){var dialog='<div></div>';$(dialog).dialog({resizable:false,width:'270px',modal:true,buttons:{'Love':function(){success();$(this).dialog('close')},'Skip':function(){cancle();$(this).dialog('close')}}});$('.ui-dialog-titlebar').remove();$('.ui-widget-overlay').css('opacity','.9');$('.ui-dialog').removeClass('ui-widget-content').addClass('jt-love-dialog');$('.ui-dialog-content').removeClass('ui-widget-content').addClass('jt-love-dialog-content');$('.ui-dialog-content').after('<div class="jt-love-dialog-ment">댓글 입력이 완료되었습니다.<br/>쇼핑몰&nbsp;'+name+'을 추천하시겠어요?</div>');$('.ui-dialog-buttonpane').removeClass('ui-widget-content').addClass('jt-love-dialog-buttonpane');$('.ui-dialog-buttonset').addClass('jt-love-dialog-buttonset');$('.ui-button').removeClass().addClass('jt-love-dialog-button')};jtown.comment.deleteComment=function(me){var $shop=me.parents('#jt-home-expand-shop'),spn=$shop.attr('data-spn');var $parents=me.parents('li');var commentPn=$parents.attr('data-copn');var url=contextPath+'ajax/home/deleteComment.jt',json={'commentPn':commentPn,'sellerPn':spn};$.postJSON(url,json,function(){})};jtown.comment.updateComment=function(me){var $parents=me.parents('li');var commentPn=$parents.attr('data-copn'),comment=me.val();var url=contextPath+'ajax/home/updateComment.jt',json={'commentPn':commentPn,'comment':comment};$.postJSON(url,json,function(comment){$parents.find('.jt-home-expand-shop-text-wrap').show();$parents.find('.jt-home-expand-shop-update-wrap').hide()})};jtown.comment.cancleComment=function(me){var $parents=me.parents('li');$parents.find('.jt-home-expand-shop-text-wrap').show();$parents.find('.jt-home-expand-shop-update-wrap').hide();var text=$parents.find('.jt-home-expand-shop-comment-text').html();$parents.find('.jt-comment-update-input').val(text)};if(typeof jtown.board=='undefined'){jtown.board={}}$(document).ready(function(){jtown.board.noticeWrite()});jtown.board.noticeWrite=function(){$('#jt-admin-noticeWrite-btn').unbind('click').bind('click',function(){var form=document.forms['board'];form._method.value='post';oEditors[0].exec("UPDATE_CONTENTS_FIELD",[]);form.submit()});$('#jt-admin-noticeUpdate-btn').unbind('click').bind('click',function(){var form=document.forms['board'];form._method.value='put';oEditors[0].exec("UPDATE_CONTENTS_FIELD",[]);form.submit()})};$(document).ready(function(){jtown.help.confirmEmail();jtown.help.name();jtown.help.phoneNumberSt();jtown.help.phoneNumberNd();jtown.help.phoneNumberRd();jtown.help.questionSync();jtown.help.confirmShopName();$('#jt-partnership-btn').bind('click',function(){var form=document.forms['partnership'];$('#loading-popup').fadeIn();form.submit()})});if(typeof jtown.help=='undefined'){jtown.help={}}jtown.help.confirmShopName=function(){$('input[name=shopName]').keyup(function(){var regExp=/^[0-9A-Za-z가-힣]*$/;var shopName=$(this).val();if(regExp.test(shopName)){$('#shopNameCheck>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#shopNameCheck>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#shopNameCheck').show()}).blur(function(){$('#shopNameCheck').hide()})};jtown.help.confirmShopUrl=function(){$('input[name=shopUrl]').keyup(function(){var shopName=$(this).val();var regExp=/^http:\/\/.*$/;var http=regExp.test(shopName);regExp=/^https:\/\/.*$/;var https=regExp.test(shopName);if(http||https){$('#shopUrlCheck>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#shopUrlCheck>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#shopUrlCheck').show()}).blur(function(){$('#shopUrlCheck').hide()})};jtown.help.confirmEmail=function(){$('input[name=email]').keyup(function(){var regExp=/^[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[@]{1}[-A-Za-z0-9_]+[-A-Za-z0-9_.]*[.]{1}[A-Za-z]{2,5}$/;var username=$(this).val();if(regExp.test(username)){$('#confirmEmail>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmEmail>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#confirmEmail').show()}).blur(function(){$('#confirmEmail').hide()})};jtown.help.name=function(){$('input[data-form=partnership]').keyup(function(){var regExp=/^[가-힣]*$/;var username=$(this).val();if(regExp.test(username)){$('#nameLength>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#nameLength>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#nameLength').show()}).blur(function(){$('#nameLength').hide()})};jtown.help.phoneNumberSt=function(){$('input[name=phoneNumberSt]').keyup(function(){var regExp=/^[0-9]*$/;var username=$(this).val();if(regExp.test(username)){$('#confirmPhoneNumber>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmPhoneNumber>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#confirmPhoneNumber').show()}).blur(function(){$('#confirmPhoneNumber').hide()})};jtown.help.phoneNumberNd=function(){$('input[name=phoneNumberNd]').keyup(function(){var regExp=/^[0-9]*$/;var username=$(this).val();if(regExp.test(username)){$('#confirmPhoneNumber>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmPhoneNumber>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#confirmPhoneNumber').show()}).blur(function(){$('#confirmPhoneNumber').hide()})};jtown.help.phoneNumberRd=function(){$('input[name=phoneNumberRd]').keyup(function(){var regExp=/^[0-9]*$/;var username=$(this).val();if(regExp.test(username)){$('#confirmPhoneNumber>span').removeClass('jt-form-invalid').addClass('jt-form-valid')}else{$('#confirmPhoneNumber>span').removeClass('jt-form-valid').addClass('jt-form-invalid')}}).focus(function(){$('#confirmPhoneNumber').show()}).blur(function(){$('#confirmPhoneNumber').hide()})};jtown.help.questionSync=function(){$('.jt-cQuestion-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['cQuestion'];BrowserDetect.init();form.browser.value=BrowserDetect.browser+'-'+BrowserDetect.version+' [ '+BrowserDetect.OS+' ] ';form.submit()});$('.jt-sQuestion-btn').bind('click',function(){$('#loading-popup').fadeIn();var form=document.forms['sQuestion'];BrowserDetect.init();form.browser.value=BrowserDetect.browser+'-'+BrowserDetect.version+' [ '+BrowserDetect.OS+' ] ';form.submit()})};